      SUBROUTINE OUT(IO,IA,IE,IZP,IW,VEC,NED,NE,NAT,MM,NN,ND,NM,EE,NP)

      INTEGER*2 MM,NN,IZP,IW

      DIMENSION MM(ND,NM),NN(ND,NM),IZP(NAT),IW(2,NED),VEC(3,NED)

     1 ,EE(NP,NP,NED)

      WRITE(IO,11)

11    FORMAT(' NEAREST NEIGHBOUR MAP'/,

     1' ATOM TYPE CONNECTIVITY',5X,'NEIGHBOURS')

12    FORMAT(I5,2I3,16I5)

      DO 13 I=IA,NAT

      ID=NN(I,1)

      ID=MIN0(ID,17)

      WRITE(IO,12)I,IZP(I),ID,(NN(I,J),J=2,ID)

      IF(ID.EQ.NN(I,1))GOTO 13

      ID=NN(I,1)

      WRITE(IO,125)(NN(I,J),J=18,ID)

125   FORMAT(12X,16I5)

13    CONTINUE

      WRITE(IO,14)NE

14    FORMAT(I6,' NON-EQUIVALENT VECTORS FOUND',/6X,'ATOM',5X

     1,'INDEX OF INTERACTION VECTORS')

      DO 15 I=IA,NAT

      ID=NN(I,1)

      ID=MIN0(ID,16)

      WRITE(IO,16)I,(MM(I,J),J=1,ID)

      IF(ID.EQ.NN(I,1))GOTO 15

      ID=NN(I,1)

      WRITE(IO,145)(MM(I,J),J=17,ID)

145   FORMAT(5X,15I5)

15    CONTINUE

16    FORMAT(17I5)

      IF(IE.EQ.0)RETURN

      WRITE(IO,19)

      DO 17 I=IE,NE

      WRITE(IO,18)I,IW(1,I),IW(2,I),(VEC(K,I),K=1,3)

     1,(EE(1,L,I),L=1,NP)

      IF(NP.EQ.1)GOTO 17

      DO 7 K=2,NP

7     WRITE(IO,21)(EE(K,L,I),L=1,NP)

17    CONTINUE

18    FORMAT(/I8,3X,2I3,3X,3F6.2,9F7.3)

19    FORMAT(/4X,' INDEX LATTICE TYPES   VECTOR',30X,'MATRIX')

21    FORMAT(38X,9F7.3)

      RETURN

      END
