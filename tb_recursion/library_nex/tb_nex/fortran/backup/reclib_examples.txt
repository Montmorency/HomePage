./ ADD NAME=CFTREC

DOS FOR A SMALL FCC CLUSTER

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.736283E-02  0.295643E-02

      -0.296524E-01  0.178592E-02

      -0.126547E-01  0.221181E-02

      -0.225989E-01  0.178256E-02

       0.296610E-02  0.141733E-02

      -0.129493E-01  0.196434E-02

      -0.136124E-01  0.141376E-02

      -0.170328E-01  0.181703E-02

      -0.161680E-01  0.173103E-02

       0.000000E+00  0.148088E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.736282E-02  0.295643E-02

      -0.302165E-01  0.228776E-02

      -0.115333E-01  0.194118E-02

      -0.137175E-01  0.151184E-02

      -0.177218E-01  0.230826E-02

      -0.111183E-01  0.203490E-02

      -0.575137E-02  0.141818E-02

      -0.307770E-02  0.160240E-02

      -0.603465E-02  0.169244E-02

       0.000000E+00  0.156978E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.736282E-02  0.295643E-02

      -0.296524E-01  0.178592E-02

      -0.148000E-01  0.252397E-02

      -0.189815E-01  0.175460E-02

       0.333550E-02  0.158708E-02

      -0.315587E-02  0.172282E-02

      -0.671181E-02  0.106508E-02

      -0.387804E-02  0.140534E-02

      -0.193543E-01  0.140736E-02

       0.000000E+00  0.152908E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.262667E-02  0.211155E-02

      -0.871496E-02  0.128841E-02

      -0.964703E-02  0.142725E-02

      -0.956568E-02  0.948351E-03

      -0.577315E-02  0.152401E-02

      -0.187157E-01  0.137076E-02

      -0.262828E-01  0.283629E-02

      -0.914314E-02  0.209163E-02

      -0.512340E-02  0.158929E-02

       0.000000E+00  0.176099E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.262666E-02  0.211155E-02

      -0.996707E-02  0.129629E-02

      -0.700937E-02  0.136906E-02

      -0.647660E-02  0.971641E-03

      -0.848719E-02  0.122450E-02

      -0.101507E-01  0.130648E-02

      -0.329977E-01  0.210095E-02

      -0.129033E-01  0.254819E-02

       0.459147E-03  0.177905E-02

       0.000000E+00  0.152031E-02

./ ADD NAME=EXRECAL

RUNFILE FROM %H=ENDJOB  PRINT=SAVE

FTVSCLR PROGRAM=%H=ENDPROG DD=FT01F001=.CFTREC/W/FB +++

LIBRARY=SSTLIB.TCMLIB.COM+SSTLIB.RECLIB+PUBLIC.CAMLIB

      INTEGER*2 MM,NN,IZERO,IZP,IW

      DIMENSION CRD(3,100),VEC(3,20),DUM(3),PSI(5,100),PMN(5,100),A(34)

     1,B2(34),IZP(100),IW(2,20)

      COMMON /BLKREC/NN(100,15),MM(100,15),NAT,NP,EE(5,5,20),IZERO(100)

      EQUIVALENCE (IZP(1),PMN(1,1))

      EQUIVALENCE (PSI(1,1),CRD(1,1))

      COMMON VEC,IW

      EXTERNAL SLKODE,HOP,FCCBND,EQUIV

C

C THIS PROGRAM COMPUTES THE RECURSION COEFFICIENTS FOR THE LOCAL D.O.S.

C FOR THE 5 D-ORBITALS ON A CENTRAL ATOM OF A SMALL F.C.C. CLUSTER OF

C ATOMS. THIS SHOULD PROVIDE A 'BLUEPRINT' FOR OTHER APPLICATIONS OF THE

C RECURSION LIBRARY; IN PARTICULAR THE ROUTINES HOP AND SET  NEED VERY

C LITTLE MODIFICATION TO BE APPROPRIATE FOR MANY ELECTRONIC D.O.S

C CALCULATIONS, AND CHANGES SHOULD BE ABLE TO BE RESTRICTED TO THE

C DIMENSION AND OUTPUT STATEMENTS.AS THE ARRAYS PSI AND PMN ARE REFERRED

C TO WITH A SINGLE SUBSCRIPT IN RECAL, THEIR FIRST DIMENSION

C SHOULD EQUAL THE NUMBER OF ORBITALS PER SITE, OTHERWISE THE BASIC

C PROGRAM IS SUITABLE FOR ANY NUMBER OF ORBITALS PER SITE.

C IN THIS EXAMPLE THE ARRAYS CRD AND IZP ARE NOT NEEDED ONCE THE

C HAMILTONIAN HAS BEEN SET UP IN /BLKREC/ AND THEY ARE THEREFORE

C EQUIVALENCED TO PSI AND PMN TO SAVE SPACE. THE 'TYPE' ARRAY IZP IS

C PROVIDED TO ENABLE INTERACTIONS BETWEEN GEOMETRICALLY EQUIVALENT

C SITES TO BE DIFFERENT, AS MAY BE REQUIRED IN LATTICES WITH TWO OR MORE

C DIFFERENT ATOM TYPES,OR IN ALLOWING SURFACE INTERACTIONS TO BE

C DIFFERENT FROM THOSE IN THE BULK.

C

      LL=11

      NED=20

      NNDIM=100

      NNMX=15

      NP=5

      NTYPE=1

      NX=5

      NY=5

      NZ=6

C

C  LL IS THE REQUIRED LENGTH OF THE CONTINUED FRACTION

C  NED IS THE DIMENSION OF ARRAYS IW,VEC AND EE

C  NNDIM IS THE SECOND DIMENSION OF ARRAYS NN & MM AND PSI,PMN & CRD

C  NNMX IS THE MAXIMUM NUMBER OF NEIGHBOUR INTERACTIONS

C  NP IS THE NUMBER OR ORBITALS PER SITE AND FIRST 2 DIMENSIONS OF EE

C  NTYPE IS THE NUMBER OF 'TYPES' OF ATOM SITE

C  FCCLAT GENERATES A F.C.C. LATTICE OF SIZE NX X NY X NZ

C

      NAT=NNDIM

      CALL FCCLAT(CRD,3,IZP,NAT,NX,NY,NZ,NTYPE)

      IF(NAT.EQ.0)STOP

        WRITE(6,4)

4       FORMAT(' OUTPUT FROM EXAMPLE RUN OF RECURSION LIBRARY - RECAL',

     1 //20H LATTICE COORDINATES)

        WRITE(6,5)(I,(CRD(J,I),J=1,3),I=1,NAT)

5       FORMAT(4(I5,3F4.1))

        CALL CLCK4X

C

C SETUP GENERATES THE COMMON BLOCK /BLKREC/ DEFINING THE

C HAMILTONIAN MATRIX

C

C  THE VARIABLES GENERATED AND PUT IN THE COMMON /BLKREC/

C

C  NN   IS THE NEIGHBOUR MAP GENERATED BY NNCAL

C  MM   IS THE INTERACTION MAP GENERATED BY MMCAL

C  NAT  IS THE NO. OF ATOMS IN THE CLUSTER

C  NP   IS THE NO. OF 'ORBITALS' ON EACH SITE

C  EE   IS THE LIST OF SUBMATRICES

C IZERO IS SUCH THAT IZERO(I)=0 IMPLIES PSI(.,I)=0.0

C

C FOR A CLUSTER OF MORE THAN 100 ATOMS ONLY THE OBVIOUS DIMENSIONS

C ABOVE NEED TO BE CHANGED , LIKEWISE FOR MORE THAN 15

C CONNECTED ATOMS

      NM=NNMX

      CALL SETUP(CRD,3,NAT,EQUIV,NTYPE,IZP,MM,NN,NNDIM,NM,SLKODE,FCCBND

     1,FCCBND,EE,NP,NED,NE,VEC,IW)

      CALL CLCK3F(IT)

        WRITE(6,6)IT

6       FORMAT(14H TIME IN SETUP,I6)

      CALL OUT(6,1,1,IZP,IW,VEC,NED,NE,NAT,MM,NN,NNDIM,NM,EE,NP)

C

C  CONSTRUCT INITIAL WAVE FUNCTION NONZERO ON ATOM 4,3,3 AND

C  COMPUTE CONTINUED FRACTION

C

      DUM(1)=4.0

      DUM(2)=3.0

      DUM(3)=3.0

      DO 41 NSTRT=1,NAT

      IF(CRD(1,NSTRT).EQ.DUM(1).AND.CRD(2,NSTRT).EQ.DUM(2).AND.

     1  CRD(3,NSTRT).EQ.DUM(3))GOTO 43

41    CONTINUE

      WRITE(6,42)

42    FORMAT(' NO SUCH ATOM TO START')

      STOP

43    CONTINUE

      WRITE(6,44) NSTRT

44    FORMAT(I6,' ATOM TAKEN AS STARTING POINT'//)

C

C COMPUTES LOCAL D.O.S. RECURSION CFTS. FOR  THE FIVE ORBITALS ON THE

C STARTING ATOM. IZERO IS AN ARRAY SET UP TO AVIOD UNNECCESSARY MATRIX

C MULTIPLICATIONS: IZERO(I)=0 IMPLIES PSI(.,I)=0.0  AND

C THE ROUTINE HOP UPDATES THIS WITH EACH APPLICATION OF THE MATRIX.

C IN THIS CASE (BECAUSE OF SYMMETRY) IT WOULD HAVE BEEN SUFFICIENT

C TO COMPUTE ONLY THE 2 DISTINCT DENSITY FUNCTIONS. THE NUMERICAL

C DISCREPENCIES IN THE ANSWERS ARE CAUSED BY LACK OF FULL SYMMETRY

C IN THE CLUSTER AND STARTING STATES.FOR THE LOCAL D.O.S. SUMMED OVER

C ALL ORBITALS ON THE STARTING ATOM , THE STARTING STATE (1,1,1,1,1)

C ON THAT ATOM COULD HAVE BEEN USED, AND B2(1) SET EQUAL TO 5.0

C

      WRITE(1,10)

10    FORMAT(' DOS FOR A SMALL FCC CLUSTER')

      DO 15 III=1,NP

        CALL CLCK4X

      DO 11 I=1,NAT

      IZERO(I)=0

      DO 11 J=1,NP

      PSI(J,I)=0.0

11    PMN(J,I)=0.0

      B2(1)=1.0

      A(LL)=0.0

      PSI(III,NSTRT)=1.0

      IZERO(NSTRT)=1

      CALL RECAL(HOP,PSI,PMN,NAT*NP,A,B2,LL)

      WRITE(1,12)LL

12    FORMAT(5X,48H CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1,,I3)

      WRITE(1,13)(A(I),B2(I),I=1,LL)

13    FORMAT(5X,2E14.6)

        CALL CLCK3F(IT)

        WRITE(6,14)IT

14      FORMAT(35H TIME TO COMPUTE TRIDIAGONALISATION,I6)

15    CONTINUE

      STOP

      END

      SUBROUTINE HOP(PSI,PMN,AN)

      INTEGER*2 MM,NN,IZERO,IDUM

      DOUBLE PRECISION SUM,DUM

      DIMENSION PSI(5,100),PMN(5,100),DUM(5)

      COMMON /BLKREC/NN(100,15),MM(100,15),NAT,NP,EE(5,5,20),IZERO(100)

      COMMON IDUM(100)

C

C HOP SATISFIES THE SPEC. IN RECAL. UNLABELLED COMMON IS USED FOR

C AN INTEGER*2 WORK ARRAY.ALL INFORMATION FOR THE MATRIX DEFINITION

C IS HELD IN THE COMMON BLOCK /BLKREC/ WHICH IS ASSIGNED IN SET

C WHERE A DESCRIPTION MAY ALSO BE FOUND.

C   IZERO(I)=0 INDICATES PSI(.,I)=0.0 AND HENCE THAT CERTAIN LINES

C MAY BE SKIPPED TO SAVE TIME.

C

      SUM=0.0

      DO 4 I=1,NAT

C

C THE MATRIX MULTIPLICATION PROCEEDS A LINE AT A TIME BY COMPUTING

C AT EACH SITE I THE EFFECT OF THE HAMILTONIAN OPERATING AT EACH

C OF ITS NEIGHBOURING SITES, WHICH ARE DEFINED BY NN(I,.)

C THE PRODUCT VECTOR IS ACCUMULATED IN DUM AND THE INNER PRODUCT

C <PSI H PSI> IN SUM.

C

      IDUM(I)=IZERO(I)

      DO 11 L=1,NP

11    DUM(L)=0.0

      JSZ=NN(I,1)

      IE=MM(I,1)

      IF(IZERO(I).EQ.0)GOTO 10

C

C MULTIPLY PSI(I) BY THE 'SELF ENERGY' MATRIX (OR DIAGONAL SUBMATRIX)

C

      DO 1 M=1,NP

      DO 1 L=1,NP

1     DUM(L)=DUM(L)+EE(L,M,IE)*PSI(M,I)

10    IF(JSZ.LT.2)GOTO 3

      DO 12 J=2,JSZ

      JJ=NN(I,J)

      IF(IZERO(JJ).EQ.0)GOTO 12

      IE=MM(I,J)

C

C MULTIPLY PSI(.,JJ) BY THE APPROPRIATE SUBMATRIX TO CALCULATE THE

C EFFECT AT SITE I OF THE HAMILTONIAN OPERATING AT SITE JJ.NOTE

C THE PSI(.,I) IS NOW NON-ZERO AND THIS IS RECORDED IN IDUM FOR

C LATER COPYING TO IZERO

C

      DO 2 M=1,NP

      DO 2 L=1,NP

2     DUM(L)=DUM(L)+EE(L,M,IE)*PSI(M,JJ)

      IDUM(I)=1

12    CONTINUE

C

C ACCUMULATE THE REQUIRED INNER PRODUCT AND OVERWRITE PMN

C

3     DO 4 L=1,NP

      SUM=SUM+DUM(L)*PSI(L,I)

4     PMN(L,I)=DUM(L)+PMN(L,I)

      AN=SUM

      DO 14 I=1,NAT

14    IZERO(I)=IDUM(I)

      RETURN

      END

ENDPROG

ENDJOB

./ ADD NAME=OPRECAL

OUTPUT FROM EXAMPLE RUN OF RECURSION LIBRARY - RECAL

LATTICE COORDINATES

   1 2.0 1.0 1.0    2 4.0 1.0 1.0    3 1.0 2.0 1.0    4 3.0 2.0 1.0

   5 5.0 2.0 1.0    6 2.0 3.0 1.0    7 4.0 3.0 1.0    8 1.0 4.0 1.0

   9 3.0 4.0 1.0   10 5.0 4.0 1.0   11 2.0 5.0 1.0   12 4.0 5.0 1.0

  13 1.0 1.0 2.0   14 3.0 1.0 2.0   15 5.0 1.0 2.0   16 2.0 2.0 2.0

  17 4.0 2.0 2.0   18 1.0 3.0 2.0   19 3.0 3.0 2.0   20 5.0 3.0 2.0

  21 2.0 4.0 2.0   22 4.0 4.0 2.0   23 1.0 5.0 2.0   24 3.0 5.0 2.0

  25 5.0 5.0 2.0   26 2.0 1.0 3.0   27 4.0 1.0 3.0   28 1.0 2.0 3.0

  29 3.0 2.0 3.0   30 5.0 2.0 3.0   31 2.0 3.0 3.0   32 4.0 3.0 3.0

  33 1.0 4.0 3.0   34 3.0 4.0 3.0   35 5.0 4.0 3.0   36 2.0 5.0 3.0

  37 4.0 5.0 3.0   38 1.0 1.0 4.0   39 3.0 1.0 4.0   40 5.0 1.0 4.0

  41 2.0 2.0 4.0   42 4.0 2.0 4.0   43 1.0 3.0 4.0   44 3.0 3.0 4.0

  45 5.0 3.0 4.0   46 2.0 4.0 4.0   47 4.0 4.0 4.0   48 1.0 5.0 4.0

  49 3.0 5.0 4.0   50 5.0 5.0 4.0   51 2.0 1.0 5.0   52 4.0 1.0 5.0

  53 1.0 2.0 5.0   54 3.0 2.0 5.0   55 5.0 2.0 5.0   56 2.0 3.0 5.0

  57 4.0 3.0 5.0   58 1.0 4.0 5.0   59 3.0 4.0 5.0   60 5.0 4.0 5.0

  61 2.0 5.0 5.0   62 4.0 5.0 5.0   63 1.0 1.0 6.0   64 3.0 1.0 6.0

  65 5.0 1.0 6.0   66 2.0 2.0 6.0   67 4.0 2.0 6.0   68 1.0 3.0 6.0

  69 3.0 3.0 6.0   70 5.0 3.0 6.0   71 2.0 4.0 6.0   72 4.0 4.0 6.0

  73 1.0 5.0 6.0   74 3.0 5.0 6.0   75 5.0 5.0 6.0

TIME IN SETUP    10

NEAREST NEIGHBOUR MAP

ATOM TYPE CONNECTIVITY     NEIGHBOURS

   1  1  6    3    4   13   14   16

   2  1  6    4    5   14   15   17

   3  1  6    1    6   13   16   18

   4  1  9    1    2    6    7   14   16   17   19

   5  1  6    2    7   15   17   20

   6  1  9    3    4    8    9   16   18   19   21

   7  1  9    4    5    9   10   17   19   20   22

   8  1  6    6   11   18   21   23

   9  1  9    6    7   11   12   19   21   22   24

  10  1  6    7   12   20   22   25

  11  1  6    8    9   21   23   24

  12  1  6    9   10   22   24   25

  13  1  6    1    3   16   26   28

  14  1  9    1    2    4   16   17   26   27   29

  15  1  6    2    5   17   27   30

  16  1 13    1    3    4    6   13   14   18   19   26   28   29   31

  17  1 13    2    4    5    7   14   15   19   20   27   29   30   32

  18  1  9    3    6    8   16   21   28   31   33

  19  1 13    4    6    7    9   16   17   21   22   29   31   32   34

  20  1  9    5    7   10   17   22   30   32   35

  21  1 13    6    8    9   11   18   19   23   24   31   33   34   36

  22  1 13    7    9   10   12   19   20   24   25   32   34   35   37

  23  1  6    8   11   21   33   36

  24  1  9    9   11   12   21   22   34   36   37

  25  1  6   10   12   22   35   37

  26  1  9   13   14   16   28   29   38   39   41

  27  1  9   14   15   17   29   30   39   40   42

  28  1  9   13   16   18   26   31   38   41   43

  29  1 13   14   16   17   19   26   27   31   32   39   41   42   44

  30  1  9   15   17   20   27   32   40   42   45

  31  1 13   16   18   19   21   28   29   33   34   41   43   44   46

  32  1 13   17   19   20   22   29   30   34   35   42   44   45   47

  33  1  9   18   21   23   31   36   43   46   48

  34  1 13   19   21   22   24   31   32   36   37   44   46   47   49

  35  1  9   20   22   25   32   37   45   47   50

  36  1  9   21   23   24   33   34   46   48   49

  37  1  9   22   24   25   34   35   47   49   50

  38  1  6   26   28   41   51   53

  39  1  9   26   27   29   41   42   51   52   54

  40  1  6   27   30   42   52   55

  41  1 13   26   28   29   31   38   39   43   44   51   53   54   56

  42  1 13   27   29   30   32   39   40   44   45   52   54   55   57

  43  1  9   28   31   33   41   46   53   56   58

  44  1 13   29   31   32   34   41   42   46   47   54   56   57   59

  45  1  9   30   32   35   42   47   55   57   60

  46  1 13   31   33   34   36   43   44   48   49   56   58   59   61

  47  1 13   32   34   35   37   44   45   49   50   57   59   60   62

  48  1  6   33   36   46   58   61

  49  1  9   34   36   37   46   47   59   61   62

  50  1  6   35   37   47   60   62

  51  1  9   38   39   41   53   54   63   64   66

  52  1  9   39   40   42   54   55   64   65   67

  53  1  9   38   41   43   51   56   63   66   68

  54  1 13   39   41   42   44   51   52   56   57   64   66   67   69

  55  1  9   40   42   45   52   57   65   67   70

  56  1 13   41   43   44   46   53   54   58   59   66   68   69   71

  57  1 13   42   44   45   47   54   55   59   60   67   69   70   72

  58  1  9   43   46   48   56   61   68   71   73

  59  1 13   44   46   47   49   56   57   61   62   69   71   72   74

  60  1  9   45   47   50   57   62   70   72   75

  61  1  9   46   48   49   58   59   71   73   74

  62  1  9   47   49   50   59   60   72   74   75

  63  1  4   51   53   66

  64  1  6   51   52   54   66   67

  65  1  4   52   55   67

  66  1  9   51   53   54   56   63   64   68   69

  67  1  9   52   54   55   57   64   65   69   70

  68  1  6   53   56   58   66   71

  69  1  9   54   56   57   59   66   67   71   72

  70  1  6   55   57   60   67   72

  71  1  9   56   58   59   61   68   69   73   74

  72  1  9   57   59   60   62   69   70   74   75

  73  1  4   58   61   71

  74  1  6   59   61   62   71   72

  75  1  4   60   62   72

   13 NON-EQUIVALENT VECTORS FOUND

     ATOM     INDEX OF INTERACTION VECTORS

   1   13    1    2    3    4    5

   2   13    1    2    3    4    5

   3   13    6    2    7    4    5

   4   13    8    6    1    2    7    3    4    5

   5   13    8    1    7    3    5

   6   13    8    6    1    2    7    3    4    5

   7   13    8    6    1    2    7    3    4    5

   8   13    6    2    7    4    5

   9   13    8    6    1    2    7    3    4    5

  10   13    8    1    7    3    5

  11   13    8    6    7    3    4

  12   13    8    6    7    3    4

  13   13    9   10    2    4    5

  14   13   11    9   10    1    2    3    4    5

  15   13   11   10    1    3    5

  16   13   12   11    9   10    8    6    1    2    7    3    4    5

  17   13   12   11    9   10    8    6    1    2    7    3    4    5

  18   13   12    9   10    6    2    7    4    5

  19   13   12   11    9   10    8    6    1    2    7    3    4    5

  20   13   12   11   10    8    1    7    3    5

  21   13   12   11    9   10    8    6    1    2    7    3    4    5

  22   13   12   11    9   10    8    6    1    2    7    3    4    5

  23   13   12    9    6    7    4

  24   13   12   11    9    8    6    7    3    4

  25   13   12   11    8    7    3

  26   13   11    9   10    1    2    3    4    5

  27   13   11    9   10    1    2    3    4    5

  28   13   12    9   10    6    2    7    4    5

  29   13   12   11    9   10    8    6    1    2    7    3    4    5

  30   13   12   11   10    8    1    7    3    5

  31   13   12   11    9   10    8    6    1    2    7    3    4    5

  32   13   12   11    9   10    8    6    1    2    7    3    4    5

  33   13   12    9   10    6    2    7    4    5

  34   13   12   11    9   10    8    6    1    2    7    3    4    5

  35   13   12   11   10    8    1    7    3    5

  36   13   12   11    9    8    6    7    3    4

  37   13   12   11    9    8    6    7    3    4

  38   13    9   10    2    4    5

  39   13   11    9   10    1    2    3    4    5

  40   13   11   10    1    3    5

  41   13   12   11    9   10    8    6    1    2    7    3    4    5

  42   13   12   11    9   10    8    6    1    2    7    3    4    5

  43   13   12    9   10    6    2    7    4    5

  44   13   12   11    9   10    8    6    1    2    7    3    4    5

  45   13   12   11   10    8    1    7    3    5

  46   13   12   11    9   10    8    6    1    2    7    3    4    5

  47   13   12   11    9   10    8    6    1    2    7    3    4    5

  48   13   12    9    6    7    4

  49   13   12   11    9    8    6    7    3    4

  50   13   12   11    8    7    3

  51   13   11    9   10    1    2    3    4    5

  52   13   11    9   10    1    2    3    4    5

  53   13   12    9   10    6    2    7    4    5

  54   13   12   11    9   10    8    6    1    2    7    3    4    5

  55   13   12   11   10    8    1    7    3    5

  56   13   12   11    9   10    8    6    1    2    7    3    4    5

  57   13   12   11    9   10    8    6    1    2    7    3    4    5

  58   13   12    9   10    6    2    7    4    5

  59   13   12   11    9   10    8    6    1    2    7    3    4    5

  60   13   12   11   10    8    1    7    3    5

  61   13   12   11    9    8    6    7    3    4

  62   13   12   11    9    8    6    7    3    4

  63   13    9   10    2

  64   13   11    9   10    1    2

  65   13   11   10    1

  66   13   12   11    9   10    8    6    1    2

  67   13   12   11    9   10    8    6    1    2

  68   13   12    9   10    6    2

  69   13   12   11    9   10    8    6    1    2

  70   13   12   11   10    8    1

  71   13   12   11    9   10    8    6    1    2

  72   13   12   11    9   10    8    6    1    2

  73   13   12    9    6

  74   13   12   11    9    8    6

  75   13   12   11    8

    INDEX LATTICE TYPES   VECTOR                              MATRIX

      1     1  1    -1.00  1.00  0.00 -0.021  0.000  0.000  0.000 -0.011

                                       0.000  0.005 -0.007  0.000  0.000

                                       0.000 -0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                      -0.011  0.000  0.000  0.000 -0.008

      2     1  1     1.00  1.00  0.00 -0.021  0.000  0.000  0.000  0.011

                                       0.000  0.005  0.007  0.000  0.000

                                       0.000  0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                       0.011  0.000  0.000  0.000 -0.008

      3     1  1    -1.00  0.00  1.00  0.005 -0.007  0.000  0.000  0.000

                                      -0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021  0.010  0.006

                                       0.000  0.000  0.010 -0.003 -0.009

                                       0.000  0.000  0.006 -0.009  0.007

      4     1  1     1.00  0.00  1.00  0.005  0.007  0.000  0.000  0.000

                                       0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021 -0.010 -0.006

                                       0.000  0.000 -0.010 -0.003 -0.009

                                       0.000  0.000 -0.006 -0.009  0.007

      5     1  1     0.00  1.00  1.00  0.005  0.000  0.007  0.000  0.000

                                       0.000 -0.021  0.000  0.010 -0.006

                                       0.007  0.000  0.005  0.000  0.000

                                       0.000  0.010  0.000 -0.003  0.009

                                       0.000 -0.006  0.000  0.009  0.007

      6     1  1     1.00 -1.00  0.00 -0.021  0.000  0.000  0.000 -0.011

                                       0.000  0.005 -0.007  0.000  0.000

                                       0.000 -0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                      -0.011  0.000  0.000  0.000 -0.008

      7     1  1     0.00 -1.00  1.00  0.005  0.000 -0.007  0.000  0.000

                                       0.000 -0.021  0.000 -0.010  0.006

                                      -0.007  0.000  0.005  0.000  0.000

                                       0.000 -0.010  0.000 -0.003  0.009

                                       0.000  0.006  0.000  0.009  0.007

      8     1  1    -1.00 -1.00  0.00 -0.021  0.000  0.000  0.000  0.011

                                       0.000  0.005  0.007  0.000  0.000

                                       0.000  0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                       0.011  0.000  0.000  0.000 -0.008

      9     1  1     1.00  0.00 -1.00  0.005 -0.007  0.000  0.000  0.000

                                      -0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021  0.010  0.006

                                       0.000  0.000  0.010 -0.003 -0.009

                                       0.000  0.000  0.006 -0.009  0.007

     10     1  1     0.00  1.00 -1.00  0.005  0.000 -0.007  0.000  0.000

                                       0.000 -0.021  0.000 -0.010  0.006

                                      -0.007  0.000  0.005  0.000  0.000

                                       0.000 -0.010  0.000 -0.003  0.009

                                       0.000  0.006  0.000  0.009  0.007

     11     1  1    -1.00  0.00 -1.00  0.005  0.007  0.000  0.000  0.000

                                       0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021 -0.010 -0.006

                                       0.000  0.000 -0.010 -0.003 -0.009

                                       0.000  0.000 -0.006 -0.009  0.007

     12     1  1     0.00 -1.00 -1.00  0.005  0.000  0.007  0.000  0.000

                                       0.000 -0.021  0.000  0.010 -0.006

                                       0.007  0.000  0.005  0.000  0.000

                                       0.000  0.010  0.000 -0.003  0.009

                                       0.000 -0.006  0.000  0.009  0.007

     13     1  1     0.00  0.00  0.00  0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

   32 ATOM TAKEN AS STARTING POINT

TIME TO COMPUTE TRIDIAGONALISATION    22

TIME TO COMPUTE TRIDIAGONALISATION    22

TIME TO COMPUTE TRIDIAGONALISATION    22

TIME TO COMPUTE TRIDIAGONALISATION    23

TIME TO COMPUTE TRIDIAGONALISATION    22

./ ENDUP











./ ADD NAME=CFTREC

DOS FOR A SMALL FCC CLUSTER

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.736283E-02  0.295643E-02

      -0.296524E-01  0.178592E-02

      -0.126547E-01  0.221181E-02

      -0.225989E-01  0.178256E-02

       0.296610E-02  0.141733E-02

      -0.129493E-01  0.196434E-02

      -0.136124E-01  0.141376E-02

      -0.170328E-01  0.181703E-02

      -0.161680E-01  0.173103E-02

       0.000000E+00  0.148088E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.736282E-02  0.295643E-02

      -0.302165E-01  0.228776E-02

      -0.115333E-01  0.194118E-02

      -0.137175E-01  0.151184E-02

      -0.177218E-01  0.230826E-02

      -0.111183E-01  0.203490E-02

      -0.575137E-02  0.141818E-02

      -0.307770E-02  0.160240E-02

      -0.603465E-02  0.169244E-02

       0.000000E+00  0.156978E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.736282E-02  0.295643E-02

      -0.296524E-01  0.178592E-02

      -0.148000E-01  0.252397E-02

      -0.189815E-01  0.175460E-02

       0.333550E-02  0.158708E-02

      -0.315587E-02  0.172282E-02

      -0.671181E-02  0.106508E-02

      -0.387804E-02  0.140534E-02

      -0.193543E-01  0.140736E-02

       0.000000E+00  0.152908E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.262667E-02  0.211155E-02

      -0.871496E-02  0.128841E-02

      -0.964703E-02  0.142725E-02

      -0.956568E-02  0.948351E-03

      -0.577315E-02  0.152401E-02

      -0.187157E-01  0.137076E-02

      -0.262828E-01  0.283629E-02

      -0.914314E-02  0.209163E-02

      -0.512340E-02  0.158929E-02

       0.000000E+00  0.176099E-02

      CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

       0.000000E+00  0.100000E+01

      -0.262666E-02  0.211155E-02

      -0.996707E-02  0.129629E-02

      -0.700937E-02  0.136906E-02

      -0.647660E-02  0.971641E-03

      -0.848719E-02  0.122450E-02

      -0.101507E-01  0.130648E-02

      -0.329977E-01  0.210095E-02

      -0.129033E-01  0.254819E-02

       0.459147E-03  0.177905E-02

       0.000000E+00  0.152031E-02

./ ADD NAME=EXPROC

RUNFILE FROM %H=ENDJOB PRINT=SAVE

FILE SSTLIB.CAMREC84:CFTREC TO &DAT/W/FB

FTVSCLR PROGRAM=%H=ENDPROG  DD=FT05F001=&DAT  LIBRARY=SSTLIB.TCMLIB.DCOM

      IMPLICIT REAL*8(A-H,O-Z)

      DIMENSION A(15,5),B2(15,5),AA(15),BB2(15),WORK(15,6)

     1,ATR(15),BTR2(15),TABS(201,5),IWK(15),EB(2),IWK2(15)

      NPTS=51

      ALP=0.5

      LL=6

      ELO=-0.15

      EHI=0.15

      EPS=5.0E-12

      ACC=1.0E-4

      NP=5

      DE=(EHI-ELO)/FLOAT(NPTS-1)

C

C  LL IS THE LENGTH OF THE C.F. , NP IS THE NUMBER OF DIFFERENT C.F.S

C  ELO-EHI IS THE RANGE OF ENERGIES OF INTEREST,

C  NPTS IS THE NUMBER OF POINTS TO BE USED IN PLOTTING

C  EPS IS THE ACCURACY REQUIRED

C

      READ(5,21)IWK

21    FORMAT(15A4)

      WRITE(6,21)IWK

      DO 1 I=1,NP

22   FORMAT(53X,I3)

      READ(5,22)LLIN

1    READ(5,2)(A(J,I),B2(J,I),J=1,LLIN)

2    FORMAT(5X,2E14.6)

3    FORMAT(' INPUT CONTINUED FRACTION CFTS.',50(/1X,10F7.3))

      WRITE(6,3)((A(I,J),B2(I,J),J=1,NP),I=1,LLIN)

C

C  COMPUTE THE SUM OF THE INPUT DENSITIES AND STORE THE RESULTING

C  COEFFICIENTS IN AA AND BB2

C

      CALL RECSUM(A,B2,15,LL,NP,AA,BB2,EPS,TABS,375)

      WRITE(6,2)

      WRITE(6,12)LL

      WRITE(6,2)(AA(J),BB2(J),J=1,LL)

C

C GENERATE TERMINATOR FOR SUMMED DENSITIES

C

      ERR=ACC

      NBP1=2

      LTR=LL

      CALL TERMGN(AA,BB2,LTR,EPS,ERR,30,EDGE,WIDTH,WEIGHT,NBP1,ATR,

     1 BTR2,IWK,WORK,15,TABS,201,IWK2)

      WRITE(6,99)EDGE,WIDTH,WEIGHT,ERR,NBP1

99    FORMAT(' EDGE',E13.5,' WIDTH',E13.5,' WEIGHT',E13.5,

     1/' ERROR IN MATCH',E13.5,' CODE',I4)

      WRITE(6,98)(ATR(I),BTR2(I),I=1,LTR)

98    FORMAT(' TERMINATOR COEFFICIENTS :',20(/2E16.8))

C

C  TABULATE D.O.S. ETC. USING C.P.C. ROUTINES

C

      WRITE(6,2)

      WRITE(6,5)

5    FORMAT(5X,' ENERGY',5X,' TERM.DOS',5X,'QUAD.DOS',4X,

     1' INTEGRATED DOS "STRUCTURAL ENERGY"')

      DO 55 I=1,NPTS

      TABS(I,1)=ELO+FLOAT(I-1)*DE

      TABS(I,5)=DENCRS(TABS(I,1),AA,BB2,LL,EDGE,WIDTH,WEIGHT,1,

     1 ATR,BTR2)

      TABS(I,2)=DENQD(TABS(I,1),TABS(I,1),AA,BB2,LL,ALP,EPS,WORK,15,

     1 NQ,NE,IWK)

      IF(NE.LE.0)GOTO 13

      TABS(I,3)=WORK(NE,2)*(ALP-1.0)

      TABS(I,4)=WORK(NE,1)*TABS(I,3)

      DO 4 J=1,NE

      TABS(I,3)=TABS(I,3)+WORK(J,2)

4     TABS(I,4)=TABS(I,4)+WORK(J,2)*WORK(J,1)

55    WRITE(6,6)TABS(I,1),TABS(I,5),(TABS(I,J),J=2,4)

6    FORMAT(5E14.5)

C

C  FIND THE FERMI ENERGY FOR INTEGER NUMBERS OF ELECTRONS

C    THE FIRST CALL FINDS THE F.E. OF THE SUMMED DENSITIES ,

C   AND THE SECOND FINDS IT FROM THE SUM OF THE ORIGINAL DENSITIES.

C  THE LATTER SHOULD BE MORE ACCURATE, GIVING SOME IDEA OF THE ACCURACY

C   OF THE APPROXIMATIONS BEING MADE.

C

      WRITE(6,2)

      WRITE(6,11)

      EB(1)=TABS(1,1)

      DO 9 M=1,4

      DUM=EB(1)

      EB(2)=TABS(NPTS,1)

      AN=FLOAT(M)

      IFT=60

      EF=FENVAL(AN,AA,BB2,15,LL,1,ACC,EPS,EB,WORK,15,IWK,IFT)

      IFT=60

      EB(2)=TABS(NPTS,1)

      EB(1)=DUM

      EFAC=FENVAL(AN,A,B2,15,LL,NP,ACC,EPS,EB,WORK,15,IWK,IFT)

      WRITE(6,10)M,EF,EFAC

      EB(1)=EF

9     CONTINUE

10   FORMAT(I12,6X,2E18.8)

11   FORMAT(' NO. OF ELECTRONS',5X,'FERMI ENERGY   MORE ACCURATE F.E.')

12   FORMAT(' RESULTANT CONTINUED FRACTION COEFFICIENTS',/I3

     1 ,' LEVELS USED')

      STOP

13    WRITE(6,14)NE,TABS(I,1)

14    FORMAT(' DENQD FAILED WITH NE=',I6,' AT E=',E13.5)

      END

ENDPROG

ENDJOB

./ ADD NAME=OPPROC

DOS FOR A SMALL FCC CLUSTER

INPUT CONTINUED FRACTION CFTS.

  0.000  1.000  0.000  1.000  0.000  1.000  0.000  1.000  0.000  1.000

-0.007  0.003 -0.007  0.003 -0.007  0.003 -0.003  0.002 -0.003  0.002

-0.030  0.002 -0.030  0.002 -0.030  0.002 -0.009  0.001 -0.010  0.001

-0.013  0.002 -0.012  0.002 -0.015  0.003 -0.010  0.001 -0.007  0.001

-0.023  0.002 -0.014  0.002 -0.019  0.002 -0.010  0.001 -0.006  0.001

  0.003  0.001 -0.018  0.002  0.003  0.002 -0.006  0.002 -0.008  0.001

-0.013  0.002 -0.011  0.002 -0.003  0.002 -0.019  0.001 -0.010  0.001

-0.014  0.001 -0.006  0.001 -0.007  0.001 -0.026  0.003 -0.033  0.002

-0.017  0.002 -0.003  0.002 -0.004  0.001 -0.009  0.002 -0.013  0.003

-0.016  0.002 -0.006  0.002 -0.019  0.001 -0.005  0.002  0.000  0.002

  0.000  0.001  0.000  0.002  0.000  0.002  0.000  0.002  0.000  0.002

RESULTANT CONTINUED FRACTION COEFFICIENTS

6 LEVELS USED

      0.555112E-17  0.500000E+01

     -0.583512E-02  0.261848E-02

     -0.257177E-01  0.181036E-02

     -0.177830E-01  0.230713E-02

     -0.188918E-01  0.186159E-02

     -0.969331E-02  0.192997E-02

EDGE -0.11241E+00 WIDTH  0.19276E+00 WEIGHT  0.50000E+01

ERROR IN MATCH  0.00000E+00 CODE   2

TERMINATOR COEFFICIENTS :

-0.16024797E-01  0.50000000E+01

-0.16024797E-01  0.23223222E-02

-0.16024797E-01  0.23223222E-02

-0.16024797E-01  0.23223222E-02

-0.16024797E-01  0.23223222E-02

-0.16024797E-01  0.23223222E-02

     ENERGY      TERM.DOS     QUAD.DOS     INTEGRATED DOS "STRUCTURAL ENERGY"

-0.15000E+00   0.00000E+00   0.10673E-01   0.11822E-03  -0.17733E-04

-0.14400E+00   0.00000E+00   0.20041E-01   0.20710E-03  -0.29822E-04

-0.13800E+00   0.00000E+00   0.39528E-01   0.37848E-03  -0.52230E-04

-0.13200E+00   0.00000E+00   0.82659E-01   0.72742E-03  -0.96020E-04

-0.12600E+00   0.00000E+00   0.18544E+00   0.14858E-02  -0.18721E-03

-0.12000E+00   0.00000E+00   0.45241E+00   0.32685E-02  -0.39222E-03

-0.11400E+00   0.00000E+00   0.12127E+01   0.78592E-02  -0.89594E-03

-0.10800E+00   0.16997E+01   0.35003E+01   0.20770E-01  -0.22432E-02

-0.10200E+00   0.90473E+01   0.92274E+01   0.57069E-01  -0.58210E-02

-0.96000E-01   0.11413E+02   0.12423E+02   0.12790E+00  -0.12278E-01

-0.90000E-01   0.93912E+01   0.10439E+02   0.19135E+00  -0.17505E-01

-0.84000E-01   0.94906E+01   0.12650E+02   0.26117E+00  -0.23244E-01

-0.78000E-01   0.11541E+02   0.15174E+02   0.34367E+00  -0.29489E-01

-0.72000E-01   0.15905E+02   0.20462E+02   0.44897E+00  -0.36597E-01

-0.66000E-01   0.23220E+02   0.28024E+02   0.59415E+00  -0.45302E-01

-0.60000E-01   0.32610E+02   0.32069E+02   0.77836E+00  -0.55023E-01

-0.54000E-01   0.39792E+02   0.29845E+02   0.96419E+00  -0.63757E-01

-0.48000E-01   0.41375E+02   0.32371E+02   0.11489E+01  -0.72493E-01

-0.42000E-01   0.39272E+02   0.33811E+02   0.13494E+01  -0.81598E-01

-0.36000E-01   0.36249E+02   0.32510E+02   0.15491E+01  -0.89509E-01

-0.30000E-01   0.33154E+02   0.30411E+02   0.17381E+01  -0.95696E-01

-0.24000E-01   0.29846E+02   0.27743E+02   0.19128E+01  -0.10033E+00

-0.18000E-01   0.26286E+02   0.25376E+02   0.20715E+01  -0.10389E+00

-0.12000E-01   0.22845E+02   0.24598E+02   0.22209E+01  -0.10690E+00

-0.60000E-02   0.20013E+02   0.23611E+02   0.23661E+01  -0.10921E+00

-0.13878E-16   0.18107E+02   0.21812E+02   0.25025E+01  -0.11046E+00

  0.60000E-02   0.17272E+02   0.20509E+02   0.26288E+01  -0.11059E+00

  0.12000E-01   0.17636E+02   0.20733E+02   0.27517E+01  -0.10961E+00

  0.18000E-01   0.19439E+02   0.22581E+02   0.28810E+01  -0.10741E+00

  0.24000E-01   0.23030E+02   0.24568E+02   0.30231E+01  -0.10386E+00

  0.30000E-01   0.28270E+02   0.24086E+02   0.31704E+01  -0.99360E-01

  0.36000E-01   0.32698E+02   0.25278E+02   0.33153E+01  -0.94837E-01

  0.42000E-01   0.32088E+02   0.28896E+02   0.34793E+01  -0.89434E-01

  0.48000E-01   0.27939E+02   0.29881E+02   0.36557E+01  -0.82323E-01

  0.54000E-01   0.26303E+02   0.36034E+02   0.38480E+01  -0.72736E-01

  0.60000E-01   0.35398E+02   0.54362E+02   0.41167E+01  -0.56849E-01

  0.66000E-01   0.12190E+03   0.57940E+02   0.44102E+01  -0.38926E-01

  0.72000E-01   0.18853E+02   0.44006E+02   0.48210E+01  -0.12890E-01

  0.78000E-01   0.12624E+01   0.94578E+01   0.49558E+01  -0.34467E-02

  0.84000E-01   0.00000E+00   0.24382E+01   0.49863E+01  -0.11528E-02

  0.90000E-01   0.00000E+00   0.77956E+00   0.49949E+01  -0.46141E-03

  0.96000E-01   0.00000E+00   0.29175E+00   0.49978E+01  -0.20940E-03

  0.10200E+00   0.00000E+00   0.12250E+00   0.49990E+01  -0.10409E-03

  0.10800E+00   0.00000E+00   0.56132E-01   0.49995E+01  -0.55459E-04

  0.11400E+00   0.00000E+00   0.27553E-01   0.49997E+01  -0.31209E-04

  0.12000E+00   0.00000E+00   0.14302E-01   0.49998E+01  -0.18362E-04

  0.12600E+00   0.00000E+00   0.77763E-02   0.49999E+01  -0.11212E-04

  0.13200E+00   0.00000E+00   0.43979E-02   0.49999E+01  -0.70656E-05

  0.13800E+00   0.00000E+00   0.25730E-02   0.50000E+01  -0.45754E-05

  0.14400E+00   0.00000E+00   0.15505E-02   0.50000E+01  -0.30341E-05

  0.15000E+00   0.00000E+00   0.95905E-03   0.50000E+01  -0.20547E-05

NO. OF ELECTRONS     FERMI ENERGY   MORE ACCURATE F.E.

          1         -0.52800692E-01   -0.52332914E-01

          2         -0.20770662E-01   -0.21286762E-01

          3          0.23056792E-01    0.23207275E-01

          4          0.57708116E-01    0.57849931E-01

./ ENDUP











./ ADD NAME=CFTPHN

EXAMPLE FOR PHONON LDOS

   7 LEVELS AT   2 SITES

ATOM    1 COORDINATE 1

  0.609375000000E+00  0.100000000000E+01

  0.329112291000E+00  0.155176640000E+00

  0.751473308000E+00  0.255199708000E-01

  0.801091731000E+00  0.207205534000E+00

  0.111061096000E+01  0.309167027000E+00

  0.803737521000E+00  0.237515718000E-01

  0.000000000000E+00  0.772026777000E-01

ATOM    1 COORDINATE 2

  0.911381662000E+00  0.100000000000E+01

  0.740966201000E+00  0.425130069000E+00

  0.946415722000E+00  0.220495343000E+00

  0.443695009000E+00  0.365933366000E-01

  0.590427458000E+00  0.689687729000E-01

  0.519128859000E+00  0.800270438000E-01

  0.000000000000E+00  0.143052824000E-01

ATOM    1 COORDINATE 3

  0.335937500000E+00  0.100000000000E+01

  0.126945305000E+01  0.286898315000E+00

  0.519608140000E+00  0.177648187000E+00

  0.569977880000E+00  0.138027556000E-01

  0.605309010000E+00  0.186092615000E+00

  0.456537068000E+00  0.234522037000E-01

  0.000000000000E+00  0.108300984000E+00

ATOM    2 COORDINATE 1

  0.339285672000E+00  0.100000000000E+01

  0.583071530000E+00  0.147560537000E+00

  0.533853590000E+00  0.229671299000E-01

  0.112207508000E+01  0.350949228000E+00

  0.843207419000E+00  0.154609919000E+00

  0.760353982000E+00  0.382584743000E-01

  0.000000000000E+00  0.359955318000E-01

ATOM    2 COORDINATE 2

  0.339285612000E+00  0.100000000000E+01

  0.832189858000E+00  0.168797076000E+00

  0.104482174000E+01  0.236061752000E+00

  0.814646065000E+00  0.206150889000E+00

  0.359184980000E+00  0.457004346000E-01

  0.752830744000E+00  0.673142672000E-01

  0.000000000000E+00  0.270433836000E-01

ATOM    2 COORDINATE 3

  0.339285612000E+00  0.100000000000E+01

  0.832197249000E+00  0.168797076000E+00

  0.104480648000E+01  0.236062169000E+00

  0.814657211000E+00  0.206150711000E+00

  0.359177232000E+00  0.457003415000E-01

  0.752839923000E+00  0.673142672000E-01

  0.000000000000E+00  0.270433389000E-01

./ ADD NAME=EXPHNDS

RUNFILE FROM %H=ENDJOB

FTVSCLR PROGRAM=%H=ENDFOR LIBRARY=SSTLIB.TCMLIB.COM+PUBLIC.CAMLIB  +++

DATA=%H=ENDAT DD=FT09F001=.CFTPHN/W/FB

      DIMENSION A(50),B2(50),COORD(3,<NAT]6>),ITYP(<NAT]6>),TITLE(6)

      INTEGER*2 NN

      COMMON /BLKHAM/DM(3,3,<MAT]50>),NDM

      COMMON /BLKMAP/NND,NNMX,NAT,NN(<NAT]6>,5)

      COMMON /BLKPAR/AA,BB(2),RTMASS(2),NON

      COMMON /BLKWFN/PSI(3,<NAT]6>),PMN(3,<NAT]6>)

      EQUIVALENCE (COORD(1,1),PSI(1,1)),(ITYP(1),PMN(1,1))

      EXTERNAL DMGEN,PRNT,DMHOP

C

C THIS PROGRAM GENERATES THE RECURSION COEFFICIENTS FOR THE

C PHONON LOCAL DENSITY OF STATES (LDOS) OF A SMALL CLUSTER OF

C ATOMS AS AN EXAMPLE OF THE METHOD THAT MAY BE USED ON MORE REALISTIC

C SYSTEMS.MOST OF THE PROGRAM AND SUBROUTINES NEED ONLY SMALL

C (IF ANY) CHANGES TO PERFORM THE CALCULATION FOR A WIDE RANGE OF

C MATERIALS, AND THESE SHOULD BE MAINLY TO DIMENSION STATEMENTS

C AND PARAMETER VALUES.THE OUTPUT MAY BE PROCESSED BY A PROGRAM

C SUCH AS PHNPLT TO PRODUCE THE ACTUAL GRAPHS OF PHON LDOS AGAINST

C FREQUENCY

C

C

C THE IMPORTANT PARAMETERS OF THE PROGRAM ARE AS FOLLOWS:

C

C  NND   FIRST DIMENION OF ARRAY NN

C  NNMX  MAXIMUM NUMBER OF NEAREST NEIGHBOURS

C  NON   REMOTENESS OF NEIGHBOURS TO BE TAKEN ONTO ACCOUNT

C          I.E. =2 FOR 1 & 2 NEIGHBOURS (BOND-STRETCHING & BENDING)

C               =1 FOR 1ST. NEIGHBOURS ONLY

C  NAT   NUMBER OF ATOMS IN THE CLUSTER

C

C    SEE SUBROUTINE DMGEN FOR A DESCRIPTION OF VARIABLES IN THE

C    COMMON BLOCKS

C

      NND=<NAT]6>

      NNMX=5

      NON=2

C

C READ NUMBER OF ATOMS IN CLUSTER, THEN 'NEIGHBOUR MAP' AND ATOM

C TYPES AND COORDINATES

C

      READ(5,21)TITLE

21    FORMAT(6A4)

      WRITE(6,22)TITLE

22    FORMAT(20X,6A4)

      WRITE(9,21)TITLE

      READ(5,1)NAT

1     FORMAT(I4)

      WRITE(6,2)NAT

2     FORMAT(20X,' CLUSTER OF',I6,' ATOMS')

      DO 4 I=1,NAT

      READ(5,3)(NN(I,J),J=1,4),ITYP(I),(COORD(J,I),J=1,3)

3     FORMAT(5I4,3F6.2)

4     CONTINUE

      DO 6 I=1,NAT

      NJ=NN(I,1)

      WRITE(6,5)I,ITYP(I),(COORD(J,I),J=1,3),(NN(I,J),J=1,NJ)

5     FORMAT(20X,2I4,3F8.2,4I4)

6     CONTINUE

C

C GENERATE DYNAMICAL MATRICES USING SCAN AND DMGEN

C AA IS BOND STRETCHING FORCE CONSTANT

C BB(J) IS BOND BENDING FORCE CONSTANT AT ATOM OF TYPE J

C RTMASS(J) IS THE ROOT INVERSE MASS OF AN ATOM OF TYPE J

C

      AA=1.0

      BB(1)=0.5

      BB(2)=0.25

      RTMASS(1)=0.25

      RTMASS(2)=SQRT(1.0/28.0)

      NDM=0

      CALL CLCK4X

      CALL SCAN(NN,NND,NNMX,1,NAT,NON,DMGEN)

      CALL CLCK3F(ITIM)

      WRITE(6,7)NDM

7     FORMAT(13X,I8,' DYNAMICAL MATRICES CALCULATED')

      WRITE(6,8)ITIM

8     FORMAT(1H+,51X,'IN',I8,' 1/100 SECS')

C

C PRINT OUT DYNAMICAL MATRICES

C

      NDM=0

      CALL SCAN(NN,NND,NNMX,1,NAT,NON,PRNT)

      NSITES=2

      NDISP=3

      LL=7

      WRITE(9,23)LL,NSITES

23    FORMAT(I4,' LEVELS AT',I4,' SITES')

      WRITE(6,11)LL

11    FORMAT(13X,I4,' LEVELS')

C

C GENERATE LOCAL DENSITY OF PHONON MODES AT THE FIRST NSITES

C ATOMS FOR NDISP CARTESIAN COORDINATES, WITH LL 'LEVELS' EACH.

C

      DO 13 II=1,NSITES

      DO 13 JJ=1,NDISP

      CALL CLCK4X

      DO 12 I=1,NAT

      DO 12 J=1,3

      PSI(J,I)=0.0

12    PMN(J,I)=0.0

      B2(1)=1.0

      PSI(JJ,II)=1.0

      CALL RECAL(DMHOP,PSI,PMN,3*NAT,A,B2,LL)

      CALL CLCK3F(ITIM)

      WRITE(9,24)II,JJ

      WRITE(9,25)(A(I),B2(I),I=1,LL)

24    FORMAT(' ATOM',I5,' COORDINATE',I2)

25    FORMAT(2E20.12)

      WRITE(6,14)II,JJ,(A(I),B2(I),I=1,LL)

      WRITE(6,8)ITIM

13    CONTINUE

14    FORMAT(20X,' ATOM',I5,' COORDINATE',I3,50(/20X,2E13.5))

      STOP

      END

      SUBROUTINE VECGEN(IA,NA,NOP)

      DIMENSION IA(NOP),NA(NOP),V(3)

      COMMON /BLKWFN/COORD(3,<NAT]6>),ITYP(<NAT]6>),JUNK(2,<NAT]6>)

      COMMON /BLKLOC/AB(3,5,5),NS

C

C SATISFIES THE SPEC. OF SUB IN SCAN, AND CALCULATES AND STORES IN THE

C COMMON BLOCK /BLKLOC/ THE NORMALISED VECTOR BETWEEN ATOMS IA(NOP-1)

C AND IA(NOP). THE COORDINATES OF THE ATOMS HAVE BEEN STORED IN COORD

C AND THE VECTORS GENERATED ARE PUT IN THE ARRAY AB WITH THE LAST TWO

C SUBSCRIPTS REFERENCING THE NEIGHBOUR INDEXES NA(NOP-1),NA(NOP) AND

C THE FIRST SUBSCRIPT REFERRING TO THE COORDINATE. IF NOP=1 NO ACTION

C IS TAKEN.

C

      IF(NOP.EQ.1)RETURN

      I=IA(NOP-1)

      J=IA(NOP)

      SUM=0.0

      DO 1 L=1,3

      V(L)=COORD(L,J)-COORD(L,I)

1     SUM=SUM+V(L)*V(L)

      SUM=1.0/SQRT(SUM)

      I=NA(NOP-1)

      J=NA(NOP)

      DO 2 L=1,3

2     AB(L,I,J)=V(L)*SUM

      RETURN

      END

      SUBROUTINE DMGEN(IA,NA,NOP)

      DIMENSION IA(NOP),NA(NOP),A(3,3)

      INTEGER*2 NN

      COMMON /BLKWFN/COORD(3,<NAT]6>),ITYP(<NAT]6>),JUNK(2,<NAT]6>)

      COMMON /BLKHAM/DM(3,3,<MAT]50>),ND

      COMMON /BLKLOC/AB(3,5,5),NS

      COMMON /BLKMAP/NND,NNMX,NAT,NN(<NAT]6>,5)

      COMMON /BLKPAR/AA,BB(2),RTMASS(2),NO

      EXTERNAL VECGEN

C

C SATISFIES SPEC. OF SUB IN SCAN AND COMPUTES AND ACCUMULATES THE

C DYNAMICAL MATRIX INTERACTING BETWEEN ATOMS IA(1) AND IA(NOP)

C ACCORDING TO THE FORMULATION IN THE THESIS OF P.E.MEEK .THE

C SELF-INTERACTION IS ACCUMULATED AS -1 * THE SUM OF ALL NEIGHBOUR

C INTERACTIONS . THE MATRICES ARE ONLY STORED IF IA(NOP).GE.IA(1),

C THOSE WHICH ARE STORED ARE PUT, IN THE ORDER GENERATED BY SCAN,

C INTO THE ARRAY DM.

C SCAN1 IS CALLED IF NOP=1 TO GENERATE THE NORMALISED VECTORS

C NEEDED FOR THE CALCULATION OF ALL INTERACTIONS OF THE CURRENT

C ATOM.

C

C VARIABLES IN THE COMMON BLOCKS:

C

C COORD  LIST OF COORDINATES OF THE ATOM CLUSTER

C  ITYP  LIST OF TYPES OF ATOMS

C  JUNK  ARRAY TO MAKE /BLKWFN/ THE CORRECT LENGTH

C

C    DM  LIST OF 3 X 3 DYNAMICAL MATRICES

C    ND  NUMBER OF MATRICES GENERATED SO FAR.( INITIALISED IN MAIN)

C

C    AB  LIST OF VECTORS GENERATED BY VECGEN CALLED FROM SCAN1

C        FOR THE CURRENT 'INITIAL' ATOM

C    NS  INDEX OF SELF-INTERACTION MATRIX FOR CURRENT 'INITIAL'

C        ATOM.USED IN ACCUMULATION OF THAT MATRIX.

C

C   NND  FIRST DIMENSION OF ARRAY NN

C  NNMX  1+ MAX. NO. OF NEIGHBOURS OF ANY ATOM

C   NAT  NO. OF ATOMS IN CLUSTER

C    NN  NEAREST NEIGHBOUR MAP (MAY BE DECLARED INTEGER*2 TO SAVE SPACE):

C        NN(I,1) = 1+NO. OF NEIGHBOURS OF ATOM I

C        NN(I,J),J=2,..,NN(I,1) LIST OF ATOM NUMBERS OF

C              NEIGHBOURS OF ATOM I

C

C    AA  BOND STRETCHING FORCE CONSTANT

C    BB  LIST OF BOND BENDING FORCE CONSTANTS CORRESPONDING TO

C        EACH ATOM TYPE.

C RTMASS LIST OF (MASS OF ATOM)**(-0.5) FOR EACH TYPE OF ATOM

C    NO  =1 FOR FIRST NEIGHBOUR INTERACTIONS ONLY (BOND STRETCHING)

C        =2 FOR 1ST. AND 2ND.NEIGHBOUR INTERACTIONS (STRETCHIN & BENDING)

C

      GOTO(1,10,20),NOP

C

C INITIALISE SELF-INTERACTION MATRIX & CONSRUCT NORMALISED VECTORS

C

1     NS=ND+1

      ND=NS

      IF(ND.GT.<MAT]50>)GOTO 33

      DO 2 L=1,3

      DO 2 M=1,3

2     DM(L,M,NS)=0.0

      CALL SCAN1(NN,NND,NNMX,IA(1),IA(1),NO,VECGEN)

      RETURN

C

C COMPUTE FIRST NEIGHBOUR INTERACTION

C

10    N1=NA(NOP)

      DO 11 L=1,3

      CON=-8.0*AA*AB(L,1,N1)

      DO 11 M=1,3

11    A(L,M)=CON*AB(M,1,N1)

      I=IA(1)

      NJ=NN(I,1)

C

C SUM OVER FIRST NEIGHBOURS OF ATOM IA(1)

C

      IT=ITYP(I)

      DO 13 JJ=2,NJ

      IF(JJ.EQ.N1)GOTO 13

      DO 12 L=1,3

      CON=-BB(IT)*(AB(L,1,N1)+AB(L,1,JJ))

      DO 12 M=1,3

12    A(L,M)=A(L,M)+CON*AB(M,1,JJ)

13    CONTINUE

C

C SUM OVER FIRST NEIGHBOURS OF ATOM IA(NOP)

C

      J=IA(NOP)

      NK=NN(J,1)

      IT=ITYP(J)

      DO 15 KK=2,NK

      IF(NN(J,KK).EQ.I)GOTO 15

      DO 14 L=1,3

      CON=-BB(IT)*AB(L,N1,KK)

      DO 14 M=1,3

14    A(L,M)=A(L,M)+CON*(AB(M,N1,KK)-AB(M,1,N1))

15    CONTINUE

      GOTO 30

C

C COMPUTE SECOND NEIGHBOUR MATRIX

C

20    J=IA(NOP-1)

      IT=ITYP(J)

      JJ=NA(NOP-1)

      KK=NA(NOP)

      DO 21 L=1,3

      CON=-BB(IT)*AB(L,JJ,KK)

      DO 21 M=1,3

21    A(L,M)=CON*AB(M,1,JJ)

C

C   ACCUMULATE SELF INTERACTION MATRIX AND STORE IF IN

C   UPPER BLOCK TRIANGLE AND SCALE ACCORDING TO APPROPRIATE MASSES

C

30    I=IA(1)

      I=ITYP(I)

      J=IA(NOP)

      J=ITYP(J)

      CON=RTMASS(I)*RTMASS(I)

      DO 31 L=1,3

      DO 31 M=1,3

31    DM(L,M,NS)=DM(L,M,NS)-A(L,M)*CON

      IF(IA(NOP).LT.IA(1))RETURN

      ND=ND+1

      IF(ND.GT.<MAT]50>)GOTO 33

      CON=RTMASS(I)*RTMASS(J)

      DO 32 L=1,3

      DO 32 M=1,3

32    DM(L,M,ND)=A(L,M)*CON

      RETURN

33    WRITE(6,34)ND

34    FORMAT(20X,' NOT ENOUGH ROOM FOR DYNAMICAL MATRICES',I6)

      STOP

      END

      SUBROUTINE PRNT(IA,NA,NOP)

      DIMENSION IA(NOP),NA(NOP)

      COMMON /BLKHAM/DM(3,3,<MAT]50>),NDM

      IF(IA(NOP).LT.IA(1))RETURN

      NDM=NDM+1

      WRITE(6,1)IA(NOP),IA(1),((DM(L,M,NDM),M=1,3),L=1,3)

1     FORMAT(20X,' MATRIX FOR RESULT OF H ON ATOM',I4,' AT ATOM',I4,

     1 3(/20X,3E13.5))

      RETURN

      END

      SUBROUTINE DMHOP(X,Y,A)

      DIMENSION X(3,<NAT]6>),Y(3,<NAT]6>)

      INTEGER*2 NN

      COMMON /BLKA/AA

      COMMON /BLKHAM/DM(3,3,<MAT]50>),NDM

      COMMON /BLKMAP/NND,NNMX,NAT,NN(<NAT]6>,5)

      COMMON /BLKPAR/AAA,BB(2),RTMASS(2),NON

      EXTERNAL MLT

C

C SATISFIES SPEC. OF HOP IN RECAL, CALLING SCAN TO PERFORM

C THE OPERATIONS WITH THE ROUTINE MLT, HAVING INITIALISED AA

C AND NDM . THE VECTORS REQUIRED ARE TRANSFERED VIA

C THE COMMON BLOCK /BLKWFN/ INSTEAD OF THE ARGUMENTS. THIS

C IS POSSIBLE BECAUSE OF THE COMMON STATEMENT IN THE MAIN

C PROGRAM AND THE STRUCTURE OF RECAL.

C

      AA=0.0

      NDM=0

      CALL SCAN(NN,NND,NNMX,1,NAT,NON,MLT)

      A=AA

      RETURN

      END

      SUBROUTINE MLT(IA,NA,NOP)

      DIMENSION IA(NOP),NA(NOP),DUM(3)

      COMMON /BLKA/AA

      COMMON /BLKHAM/DM(3,3,<MAT]50>),NDM

      COMMON /BLKWFN/PSI(3,<NAT]6>),PMN(3,<NAT]6>)

C

C SATISFIES THE SPEC. OF SUB IN SCAN, COMPUTING THE PRODUCT

C OF THE DYNAMICAL MATRIX ,H, (CONSTRUCTED IN DMGEN) AND A

C VECTOR ,PSI, STORED IN COMMON /BLKWFN/ .THE RESULT OF

C PMN + H. PSI IS OVERWRITTEN ONTO PMN AND PSI.H.PSI ONTO AA

C

      N=IA(1)

      NN=IA(NOP)

      IF(NN.LT.N)RETURN

C

C COMPUTE THE EFFECT AT ATOM N OF H OPERATING ON ATOM NN

C

      NDM=NDM+1

      DO 1 L=1,3

1     DUM(L)=0.0

      DO 2 M=1,3

      DO 2 L=1,3

2     DUM(L)=DUM(L)+DM(L,M,NDM)*PSI(M,NN)

      DO 3 L=1,3

      AA=AA+DUM(L)*PSI(L,N)

3     PMN(L,N)=PMN(L,N)+DUM(L)

      IF(N.EQ.NN)RETURN

C

C COMPUTE THE EFFECT AT ATOM NN OF H OPERATING ON ATOM N

C

      DO 11 L=1,3

11    DUM(L)=0.0

      DO 12 M=1,3

      DO 12 L=1,3

12    DUM(L)=DUM(L)+DM(M,L,NDM)*PSI(M,N)

      DO 13 L=1,3

      AA=AA+DUM(L)*PSI(L,NN)

13    PMN(L,NN)=PMN(L,NN)+DUM(L)

      RETURN

      END

ENDFOR

EXAMPLE FOR PHONON LDOS

   6

   4   2   3   6   1  0.00  0.00  0.00

   4   1   3   4   2  0.00  1.00  0.0

   4   1   2   5   1  0.0   1.0   1.0

   4   2   5   6   1  1.0   1.0   0.0

   4   3   4   6   2  1.0   1.0   1.0

   4   1   4   5   2  1.0   0.0   0.0

ENDAT

ENDJOB

./ ADD NAME=OPPHNDS

                    EXAMPLE FOR PHONON LDOS

                    CLUSTER OF     6 ATOMS

                      1   1    0.00    0.00    0.00   4   2   3   6

                      2   2    0.00    1.00    0.00   4   1   3   4

                      3   1    0.00    1.00    1.00   4   1   2   5

                      4   1    1.00    1.00    0.00   4   2   5   6

                      5   2    1.00    1.00    1.00   4   3   4   6

                      6   2    1.00    0.00    0.00   4   1   4   5

                  33 DYNAMICAL MATRICES CALCULATED

                                                   IN       0 1/100 SECS

                    MATRIX FOR RESULT OF H ON ATOM   1 AT ATOM   1

                     0.60938E+00  0.53347E-01  0.22097E-01

                     0.53347E-01  0.91138E+00  0.31116E+00

                     0.22097E-01  0.31116E+00  0.33594E+00

                    MATRIX FOR RESULT OF H ON ATOM   2 AT ATOM   1

                    -0.35434E-01  0.11811E-01  0.00000E+00

                    -0.23623E-01 -0.40648E+00 -0.28515E-01

                     0.00000E+00 -0.28161E-08 -0.23623E-01

                    MATRIX FOR RESULT OF H ON ATOM   3 AT ATOM   1

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00 -0.15625E-01  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   4 AT ATOM   1

                     0.00000E+00 -0.15625E-01  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   3 AT ATOM   1

                    -0.62500E-01  0.22097E-01  0.22097E-01

                    -0.22097E-01 -0.30335E+00 -0.25000E+00

                    -0.22097E-01 -0.29419E+00 -0.30335E+00

                    MATRIX FOR RESULT OF H ON ATOM   2 AT ATOM   1

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.16704E-01  0.16704E-01

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   1

                     0.00000E+00 -0.16704E-01 -0.16704E-01

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   1

                    -0.37796E+00 -0.40327E-01 -0.16704E-01

                     0.20163E-01 -0.53151E-01 -0.17717E-01

                     0.83519E-02 -0.17717E-01 -0.17717E-01

                    MATRIX FOR RESULT OF H ON ATOM   4 AT ATOM   1

                     0.00000E+00  0.00000E+00  0.00000E+00

                    -0.15625E-01  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   1

                     0.00000E+00  0.00000E+00  0.00000E+00

                    -0.83519E-02  0.00000E+00  0.00000E+00

                    -0.83519E-02  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   2 AT ATOM   2

                     0.33929E+00 -0.89286E-02  0.89286E-02

                    -0.89286E-02  0.33929E+00  0.89286E-02

                     0.89286E-02  0.89286E-02  0.33929E+00

                    MATRIX FOR RESULT OF H ON ATOM   3 AT ATOM   2

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.16704E-01  0.00000E+00

                     0.00000E+00  0.16704E-01  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   2

                     0.00000E+00  0.17857E-01  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   3 AT ATOM   2

                    -0.35434E-01  0.00000E+00  0.23623E-01

                     0.00000E+00 -0.23623E-01 -0.28515E-01

                    -0.11811E-01 -0.28161E-08 -0.40648E+00

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   2

                     0.00000E+00  0.00000E+00 -0.17857E-01

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   4 AT ATOM   2

                    -0.37796E+00  0.11811E-01 -0.11811E-01

                    -0.23623E-01 -0.35434E-01  0.00000E+00

                     0.23623E-01  0.00000E+00 -0.35434E-01

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   2

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    -0.17857E-01  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   2

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.17857E-01  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   3 AT ATOM   3

                     0.60938E+00 -0.22097E-01 -0.53347E-01

                    -0.22097E-01  0.33594E+00  0.31116E+00

                    -0.53347E-01  0.31116E+00  0.91138E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   3

                     0.00000E+00  0.16704E-01  0.16704E-01

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   4 AT ATOM   3

                     0.00000E+00  0.00000E+00  0.15625E-01

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   3

                    -0.37796E+00  0.16704E-01  0.40327E-01

                    -0.83519E-02 -0.17717E-01 -0.17717E-01

                    -0.20163E-01 -0.17717E-01 -0.53151E-01

                    MATRIX FOR RESULT OF H ON ATOM   4 AT ATOM   3

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.15625E-01  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   3

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.83519E-02  0.00000E+00  0.00000E+00

                     0.83519E-02  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   4 AT ATOM   4

                     0.59375E+00  0.31250E-01 -0.31250E-01

                     0.31250E-01  0.59375E+00 -0.15625E-01

                    -0.31250E-01 -0.15625E-01  0.59375E+00

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   4

                    -0.35434E-01  0.00000E+00 -0.11811E-01

                     0.00000E+00 -0.29528E-01 -0.14258E-01

                     0.23623E-01  0.17717E-01 -0.39222E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   4

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00  0.83519E-02

                     0.00000E+00  0.00000E+00  0.83519E-02

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   4

                    -0.35434E-01  0.11811E-01  0.00000E+00

                    -0.23623E-01 -0.39222E+00  0.17717E-01

                     0.00000E+00 -0.14258E-01 -0.29528E-01

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   4

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.83519E-02  0.00000E+00

                     0.00000E+00  0.83519E-02  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   5 AT ATOM   5

                     0.33036E+00  0.63135E-02  0.15242E-01

                     0.63135E-02  0.18750E+00  0.16703E+00

                     0.15242E-01  0.16703E+00  0.49477E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   5

                     0.00000E+00  0.00000E+00  0.00000E+00

                     0.00000E+00  0.00000E+00 -0.17857E-01

                     0.00000E+00  0.00000E+00  0.00000E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   5

                    -0.17857E-01  0.63135E-02  0.63135E-02

                    -0.63135E-02 -0.15810E+00 -0.15548E+00

                    -0.63135E-02 -0.14286E+00 -0.15810E+00

                    MATRIX FOR RESULT OF H ON ATOM   6 AT ATOM   6

                     0.33036E+00 -0.15242E-01 -0.63135E-02

                    -0.15242E-01  0.49477E+00  0.16703E+00

                    -0.63135E-02  0.16703E+00  0.18750E+00

               7 LEVELS

                    ATOM    1 COORDINATE  1

                     0.60938E+00  0.10000E+01

                     0.32911E+00  0.15518E+00

                     0.75147E+00  0.25520E-01

                     0.80109E+00  0.20721E+00

                     0.11106E+01  0.30917E+00

                     0.80374E+00  0.23752E-01

                     0.00000E+00  0.77203E-01

                                                   IN       1 1/100 SECS

                    ATOM    1 COORDINATE  2

                     0.91138E+00  0.10000E+01

                     0.74097E+00  0.42513E+00

                     0.94642E+00  0.22050E+00

                     0.44370E+00  0.36593E-01

                     0.59043E+00  0.68969E-01

                     0.51913E+00  0.80027E-01

                     0.00000E+00  0.14305E-01

                                                   IN       1 1/100 SECS

                    ATOM    1 COORDINATE  3

                     0.33594E+00  0.10000E+01

                     0.12695E+01  0.28690E+00

                     0.51961E+00  0.17765E+00

                     0.56998E+00  0.13803E-01

                     0.60531E+00  0.18609E+00

                     0.45654E+00  0.23452E-01

                     0.00000E+00  0.10830E+00

                                                   IN       1 1/100 SECS

                    ATOM    2 COORDINATE  1

                     0.33929E+00  0.10000E+01

                     0.58307E+00  0.14756E+00

                     0.53385E+00  0.22967E-01

                     0.11221E+01  0.35095E+00

                     0.84321E+00  0.15461E+00

                     0.76035E+00  0.38258E-01

                     0.00000E+00  0.35996E-01

                                                   IN       1 1/100 SECS

                    ATOM    2 COORDINATE  2

                     0.33929E+00  0.10000E+01

                     0.83219E+00  0.16880E+00

                     0.10448E+01  0.23606E+00

                     0.81465E+00  0.20615E+00

                     0.35918E+00  0.45700E-01

                     0.75283E+00  0.67314E-01

                     0.00000E+00  0.27043E-01

                                                   IN       1 1/100 SECS

                    ATOM    2 COORDINATE  3

                     0.33929E+00  0.10000E+01

                     0.83220E+00  0.16880E+00

                     0.10448E+01  0.23606E+00

                     0.81466E+00  0.20615E+00

                     0.35918E+00  0.45700E-01

                     0.75284E+00  0.67314E-01

                     0.00000E+00  0.27043E-01

                                                   IN       1 1/100 SECS





./ ENDUP











./ ADD NAME=CFTPHN

EXAMPLE FOR PHONON LDOS

   7 LEVELS AT   2 SITES

ATOM    1 COORDINATE 1

  0.609375000000E+00  0.100000000000E+01

  0.329112291000E+00  0.155176640000E+00

  0.751473308000E+00  0.255199708000E-01

  0.801091731000E+00  0.207205534000E+00

  0.111061096000E+01  0.309167027000E+00

  0.803737521000E+00  0.237515718000E-01

  0.000000000000E+00  0.772026777000E-01

ATOM    1 COORDINATE 2

  0.911381662000E+00  0.100000000000E+01

  0.740966201000E+00  0.425130069000E+00

  0.946415722000E+00  0.220495343000E+00

  0.443695009000E+00  0.365933366000E-01

  0.590427458000E+00  0.689687729000E-01

  0.519128859000E+00  0.800270438000E-01

  0.000000000000E+00  0.143052824000E-01

ATOM    1 COORDINATE 3

  0.335937500000E+00  0.100000000000E+01

  0.126945305000E+01  0.286898315000E+00

  0.519608140000E+00  0.177648187000E+00

  0.569977880000E+00  0.138027556000E-01

  0.605309010000E+00  0.186092615000E+00

  0.456537068000E+00  0.234522037000E-01

  0.000000000000E+00  0.108300984000E+00

ATOM    2 COORDINATE 1

  0.339285672000E+00  0.100000000000E+01

  0.583071530000E+00  0.147560537000E+00

  0.533853590000E+00  0.229671299000E-01

  0.112207508000E+01  0.350949228000E+00

  0.843207419000E+00  0.154609919000E+00

  0.760353982000E+00  0.382584743000E-01

  0.000000000000E+00  0.359955318000E-01

ATOM    2 COORDINATE 2

  0.339285612000E+00  0.100000000000E+01

  0.832189858000E+00  0.168797076000E+00

  0.104482174000E+01  0.236061752000E+00

  0.814646065000E+00  0.206150889000E+00

  0.359184980000E+00  0.457004346000E-01

  0.752830744000E+00  0.673142672000E-01

  0.000000000000E+00  0.270433836000E-01

ATOM    2 COORDINATE 3

  0.339285612000E+00  0.100000000000E+01

  0.832197249000E+00  0.168797076000E+00

  0.104480648000E+01  0.236062169000E+00

  0.814657211000E+00  0.206150711000E+00

  0.359177232000E+00  0.457003415000E-01

  0.752839923000E+00  0.673142672000E-01

  0.000000000000E+00  0.270433389000E-01

./ ADD NAME=EXPHNPLT

RUNFILE FROM %H=ENDJOB

FILE SSTLIB.CAMREC84:CFTPHN TO &DAT/W/FB

FTVSCLR PROGRAM=%H=ENDPROG  DD=FT05F001=&DAT  LIBRARY=SSTLIB.TCMLIB.DCOM

      IMPLICIT REAL*8(A-H,O-Z)

      DIMENSION A(100,18),B2(100,18),AA(100),BB2(100),WK(100,18,5)

     1,TABS(511,3),IWK(100),TITL(6),NAT(6),W1(100),W2(100),W3(100)

      NDIM=100

      IO=6

      NPTS=21

      WLO=0.0

      WHI=1.5

      ALP=0.5

      EPS=5.0E-8

      READ(5,11)TITL

11    FORMAT(6A4)

      WRITE(IO,10)TITL

10     FORMAT(10X,6A4)

      READ(5,12)LL,NS

12    FORMAT(I4,10X,I4)

      NP=NS*3

C

C  NDIM IS FIRST DIMENSION OF ARRAYS A AND B2

C  NPTS IS NUMBER OF POINTS OF TABULATION

C  WLO-WHI IS THE RANGE OF FREQUENCIES OF INTEREST,

C  EPS IS THE ACCURACY REQUIRED

C  TITL HOLDS THE TITLE TO BE COPIED FROM INPUT TO OUTPUT

C  LL IS THE LENGTH OF THE CONTINUED FRACTIONS

C  NS IS THE NUMBER OF ATOMS AT WHICH THE PHONON LDOS IS CALCULATED

C  NP (=3*NS) IS THUS THE NUMBER OF SETS OF CONTINUED FRACTION CFTS

C

C  READ IN COEFFICIENTS

C

      DO 1 I=1,NP

      II=(I-1)/3+1

      READ(5,14)NAT(II),IC

14    FORMAT(5X,I5,11X,I2)

      READ(5,2)(A(J,I),B2(J,I),J=1,LL)

1    CONTINUE

2    FORMAT(2E20.12)

      WRITE(IO,13)LL,NS

13    FORMAT(10X,I4,' LEVELS AT',I4,' SITES')

      WRITE(IO,23)(NAT(I),I=1,NS)

23    FORMAT(10X,' ATOMS',10I5)

      DO 4 JJ=1,NP,3

      JM=MIN0(JJ+2,NP)

      WRITE(IO,3)((A(I,J),B2(I,J),J=JJ,JM),I=1,LL)

3    FORMAT(10X,' INPUT CONTINUED FRACTION CFTS.',50(/10X,6E11.4))

4     CONTINUE

C

C  COMPUTE THE SUM OF THE INPUT DENSITIES AND STORE THE RESULTING

C  COEFFICIENTS IN AA AND BB2

C

      CALL RECSUM(A,B2,NDIM,LL,NP,AA,BB2,EPS,WK,5*LL*NP)

      WRITE(IO,2)

      WRITE(IO,22)

22   FORMAT(10X,' RESULTANT CONTINUED FRACTION COEFFICIENTS')

      WRITE(IO,24)(AA(J),BB2(J),J=1,LL)

24    FORMAT(10X,2E20.12)

      DX=(WHI-WLO)/FLOAT(NPTS-1)

      WRITE(IO,2)

C

C  TABULATE PHONON LDOS GIVEN BY 2*W*N(W*W)

C  WHERE N(E) CORRESPONDS TO AN ELECTRON LDOS

C  TABS(I,1) CONTAINS W

C  TABS(I,2) CONTAINS THE PHONON LOCAL DENSITY OF STATES

C  TABS(I,3) CONTAINS THE INTEGRAL OF THE ABOVE

C

      WRITE(IO,5)

5    FORMAT(18X,' OMEGA',5X,' DENSITY OF PHONON MODES INTEGRATED ',

     1'D.O.S.')

      DO 15 I=1,NPTS

      TABS(I,1)=WLO+FLOAT(I-1)*DX

      E=TABS(I,1)*TABS(I,1)

      TABS(I,2)=2.0*TABS(I,1)*DENQD(E,E,AA,BB2,LL,ALP,EPS,WK,NDIM,

     1 NQ,NE,IWK)

      IF(NE.GT.0)GOTO 42

      WRITE(IO,41)WK(I,1,1),NE,I

41    FORMAT(' TROUBLE AT E=',' NQ=',I3,' I=',I3)

      STOP

42    TABS(I,3)=WK(NE,2,1)*(ALP-1.0)

      DO 43 J=1,NE

43    TABS(I,3)=TABS(I,3)+WK(J,2,1)

      TABS(I,3)=TABS(I,3)*2.0

      WRITE(IO,6)(TABS(I,J),J=1,3)

15    CONTINUE

6    FORMAT(10X,3E20.8)

      STOP

      END

ENDPROG

ENDJOB

./ ADD NAME=OPPHNPLT

          EXAMPLE FOR PHONON LDOS

            7 LEVELS AT   2 SITES

          ATOMS    1    2

          INPUT CONTINUED FRACTION CFTS.

          0.6094D+00 0.1000D+01 0.9114D+00 0.1000D+01 0.3359D+00 0.1000D+01

          0.3291D+00 0.1552D+00 0.7410D+00 0.4251D+00 0.1269D+01 0.2869D+00

          0.7515D+00 0.2552D-01 0.9464D+00 0.2205D+00 0.5196D+00 0.1776D+00

          0.8011D+00 0.2072D+00 0.4437D+00 0.3659D-01 0.5700D+00 0.1380D-01

          0.1111D+01 0.3092D+00 0.5904D+00 0.6897D-01 0.6053D+00 0.1861D+00

          0.8037D+00 0.2375D-01 0.5191D+00 0.8003D-01 0.4565D+00 0.2345D-01

          0.0000D+00 0.7720D-01 0.0000D+00 0.1431D-01 0.0000D+00 0.1083D+00

          INPUT CONTINUED FRACTION CFTS.

          0.3393D+00 0.1000D+01 0.3393D+00 0.1000D+01 0.3393D+00 0.1000D+01

          0.5831D+00 0.1476D+00 0.8322D+00 0.1688D+00 0.8322D+00 0.1688D+00

          0.5339D+00 0.2297D-01 0.1045D+01 0.2361D+00 0.1045D+01 0.2361D+00

          0.1122D+01 0.3509D+00 0.8146D+00 0.2062D+00 0.8147D+00 0.2062D+00

          0.8432D+00 0.1546D+00 0.3592D+00 0.4570D-01 0.3592D+00 0.4570D-01

          0.7604D+00 0.3826D-01 0.7528D+00 0.6731D-01 0.7528D+00 0.6731D-01

          0.0000D+00 0.3600D-01 0.0000D+00 0.2704D-01 0.0000D+00 0.2704D-01

          RESULTANT CONTINUED FRACTION COEFFICIENTS

           0.479091843000D+00  0.600000000000D+01

           0.914120235939D+00  0.272556399572D+00

           0.103566428624D+01  0.253600669494D+00

           0.557354584960D+00  0.109221130287D+00

           0.493633149415D+00  0.572026496089D-01

           0.643389244701D+00  0.970442487892D-01

           0.670391962047D+00  0.186968054287D-01

                  OMEGA      DENSITY OF PHONON MODES INTEGRATED D.O.S.

               0.00000000D+00      0.00000000D+00      0.20061257D+01

               0.75000000D-01      0.25993608D+01      0.23528144D+01

               0.15000000D+00      0.87579080D+01      0.36216510D+01

               0.22500000D+00      0.28957244D+01      0.44002676D+01

               0.30000000D+00      0.25745059D+01      0.47668401D+01

               0.37500000D+00      0.28424823D+01      0.52378133D+01

               0.45000000D+00      0.31774934D+01      0.57207138D+01

               0.52500000D+00      0.12332777D+01      0.60182049D+01

               0.60000000D+00      0.18157666D+01      0.62126757D+01

               0.67500000D+00      0.41979454D+01      0.67598706D+01

               0.75000000D+00      0.30157468D+01      0.73864784D+01

               0.82500000D+00      0.15131930D+01      0.76560981D+01

               0.90000000D+00      0.79309662D+01      0.82050211D+01

               0.97500000D+00      0.12143623D+02      0.96894785D+01

               0.10500000D+01      0.10205478D+01      0.10918245D+02

               0.11250000D+01      0.27673040D-01      0.10953992D+02

               0.12000000D+01      0.40566780D-02      0.10955601D+02

               0.12750000D+01      0.52478330D+00      0.10960721D+02

               0.13500000D+01      0.37333981D-03      0.11999986D+02

               0.14250000D+01      0.10540232D-04      0.11999999D+02

               0.15000000D+01      0.83387870D-06      0.12000000D+02

./ ENDUP











./ ADD NAME=CFTPEEL

CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

ORBITAL PEELING ON A     76 ATOM FCC CLUSTER

   2 POSTIONS  3 ORBITALS PER POSITION

ADD ATOM POSITION  0.30000E+01  0.20000E+01  0.00000E+00

ORBITAL  1

  0.500000E+00  0.100000E+01

  0.472490E+00  0.421663E-01

  0.195485E-01  0.148046E-01

-0.474055E-02  0.149503E-02

  0.273241E+00  0.494780E-02

  0.195113E+00  0.687933E-01

-0.102151E-01  0.334883E-02

-0.147545E-01  0.214047E-02

  0.342035E+00  0.637294E-02

  0.175120E+00  0.626467E-01

  0.000000E+00  0.143511E-01

ORBITAL  2

  0.500000E+00  0.100000E+01

-0.210645E-02  0.217033E-02

  0.189660E-01  0.164294E-02

  0.418913E+00  0.116863E-01

  0.243933E-01  0.285045E-01

-0.138919E-01  0.225610E-02

-0.208938E-01  0.223641E-02

  0.191802E-01  0.223003E-02

  0.424895E+00  0.159673E-01

  0.386033E-01  0.232389E-01

  0.000000E+00  0.202028E-02

ORBITAL  3

  0.500000E+00  0.100000E+01

  0.150466E-01  0.376133E-02

  0.137119E-01  0.141815E-02

  0.442441E+00  0.130259E-01

  0.238727E-01  0.165956E-01

  0.974502E-02  0.165485E-02

  0.414811E+00  0.103798E-01

  0.488939E-01  0.332176E-01

-0.186314E-01  0.236497E-02

-0.245824E-01  0.223357E-02

  0.000000E+00  0.222820E-02

ADD ATOM POSITION  0.35000E+01  0.20000E+01  0.00000E+00

ORBITAL  1

  0.500000E+00  0.100000E+01

  0.479266E+00  0.418092E-01

  0.149541E-01  0.116840E-01

-0.393662E-02  0.805302E-03

  0.323287E+00  0.399280E-02

  0.164708E+00  0.588453E-01

-0.130959E-01  0.296249E-02

  0.249305E+00  0.391418E-02

  0.218901E+00  0.716211E-01

  0.293668E-01  0.434358E-02

  0.000000E+00  0.267288E-01

ORBITAL  2

  0.500000E+00  0.100000E+01

  0.121590E-02  0.145422E-02

  0.149097E+00  0.220581E-02

  0.327785E+00  0.569488E-01

-0.534916E-02  0.639670E-02

-0.176335E-01  0.227237E-02

-0.143229E-01  0.192824E-02

  0.305057E-01  0.269906E-02

  0.429294E+00  0.240395E-01

  0.144589E-01  0.153132E-01

  0.000000E+00  0.199830E-02

ORBITAL  3

  0.500000E+00  0.100000E+01

-0.607080E-02  0.321656E-02

  0.165253E+00  0.198901E-02

  0.330382E+00  0.577389E-01

-0.199082E-01  0.466610E-02

  0.185080E-01  0.211702E-02

  0.413457E+00  0.199067E-01

  0.211744E-01  0.232999E-01

-0.108829E-01  0.218336E-02

-0.124163E-01  0.188544E-02

  0.000000E+00  0.175913E-02

./ ADD NAME=EXORPEEL

RUNFILE FROM %H=ENDJOB PRINT=SAVE

FTVSCLR PROGRAM=%H=ENDPROG DD=FT01F001=.CFTPEEL/W/FB +++

LIBRARY=SSTLIB.TCMLIB.COM+SSTLIB.RECLIB+PUBLIC.CAMLIB

        INTEGER*2 MM,NN,IZERO,IZP,MEM,IW

      DIMENSION VEC(3,60),CRD(3,100),IZP(100),MEM(3,15),IW(2,60)

      DIMENSION PSI(5,100),PMN(5,100),A(34),B2(34)

        COMMON /BLKREC/NN(100,15),MM(100,15),NAT,NP,EE(5,5,60)

     1,IZERO(100)

      COMMON DUM(3)

      EXTERNAL SLKODE,HOP,FCCBND,EQUIV,PADDOV,PADBND,PADD

C

C THIS PROGRAM COMPUTES THE RECURSION COEFFICIENTS FOR THE LOCAL D.O.S.

C FOR THE 3 P-ORBITALS ON A SURFACE ATOM OF A SMALL F.C.C. CLUSTER OF

C ATOMS INTERACTING VIA THEIR D-ELECTRONS.

C

      NNDIM=100

      INTDIM=15

      NED=60

      LL=11

      NORP=3

      NP=5

      NTYPE=1

      NX=5

      NY=5

      NZ=6

      NPOSN=2

C

C  NNDIM   IS THE FIRST DIMENSION OF ARRAYS NN & MM AND LAST OF CRD

C  INTDIM  IS THE SECOND DIMENSION OF ARRAYS NN & MM

C  NED     IS THE LAST DIMENSION OF IW,VEC AND EE

C  LL     IS THE REQUIRED LENGTH OF THE CONTINUED FRACTION

C  NORP  THE NUMBER OF ORBITALS TO BE PEELED

C  NP IS THE NUMBER OF ORBITALS PER ATOM SITE

C  NTYPE IS THE NUMBER OF 'TYPES' OF ATOM SITE INITIALLY

C  FCCLAT GENERATES A F.C.C. LATTICE OF SIZE NX X NY X NZ

C  NPOSN IS THE NUMBER OF ADD ATOM POSTIONS REQUIRED

C

      NAT=NNDIM

      CALL FCCLAT(CRD,3,IZP,NAT,NX,NY,NZ,NTYPE)

      IF(NAT.EQ.0)STOP

        WRITE(6,4)

4       FORMAT(' EXAMPLE OF RECURSION WITH ORBITAL PEELING',

     1 /20H LATTICE COORDINATES)

        WRITE(6,5)(I,(CRD(J,I),J=1,3),I=1,NAT)

5       FORMAT(4(I5,3F4.1))

        CALL CLCK4X

C

C SETUP ASSEMBLES THE HAMILTONIAN MATRIX USING THE SUPPLIED ROUTINES

C EQUIV,SLKODE, AND FCCBFE, AND THE LIBRARY ROUTINES NNCAL,MMCAL .

C THE INFORMATION IS STORED IN THE COMMON BLOCK /BLKREC/ FOR USE BY HOP

C

C  NN   IS THE NEIGHBOUR MAP GENERATED BY NNCAL

C  MM   IS THE INTERACTION MAP GENERATED BY MMCAL

C  NAT  IS THE NO. OF ATOMS IN THE CLUSTER

C  NP   IS THE NO. OF 'ORBITALS' ON EACH SITE

C  EE   IS THE LIST OF SUBMATRICES

C IZERO IS SUCH THAT IZERO(I)=0 IMPLIES PSI(.,I)=0.0

C

C FOR A CLUSTER OF MORE THAN 100 ATOMS ONLY THE OBVIOUS DIMENSIONS

C ABOVE NEED TO BE CHANGED , LIKEWISE FOR MORE THAN 15

C CONNECTED ATOMS ; THE ONLY OTHER CHANGES  ARE THE CORRESPONDING

C DIMENSION INFORMATION NNDIM AND INTDIM

C

C SETUP IS CALLED TO GENERATE THE D-ELECTRON INTERACTIONS OF THE

C FCC CLUSTER

C

      NM=INTDIM

      CALL SETUP(CRD,3,NAT,EQUIV,NTYPE,IZP,MM,NN,NNDIM,NM,SLKODE

     1,FCCBND,FCCBND,EE,NP,NED,NE,VEC,IW)

      CALL CLCK3F(IT)

      WRITE(6,6)IT

6       FORMAT(' TIME IN SETUP',I6)

      CALL OUT(6,1,1,IZP,IW,VEC,NED,NE,NAT,MM,NN,NNDIM,INTDIM,EE,NP)

C

C ADD ONE ATOM TO THE CLUSTER AND COMPUTE THE P-ELECTRON INTERACTIONS

C USING THE ROUTINE ADDAT

C

      NAT=NAT+1

      CRD(3,NAT)=0.0

      CRD(2,NAT)=2.0

      CRD(1,NAT)=2.0

      IZP(NAT)=-2

      CALL CLCK4X

      NE1=NE

      NM=INTDIM

      CALL ADDAT(CRD,3,NAT,EQUIV,IZP,MM,NN,NNDIM,NM,PADBND,

     1NE,EE,NP,VEC,IW,NED,PADDOV,PADD)

      CALL CLCK3F(IT)

      WRITE(6,7)IT

7     FORMAT(' TIME IN ADDAT',I6)

      CALL OUT(6,NAT,NE1,IZP,IW,VEC,NED,NE,NAT,MM,NN,NNDIM,INTDIM,EE,NP)

      IZP(NAT)=-IZP(NAT)

      WRITE(1,12)LL

      WRITE(1,10)NAT,NPOSN,NORP

10    FORMAT(' ORBITAL PEELING ON A ',I6,' ATOM FCC CLUSTER',/I4

     1,' POSTIONS',I3,' ORBITALS PER POSITION')

C

C ADD A SECOND ATOM TO THE SURFACE IN VARIOUS PLACES

C

      DO 17 NADD=1,NPOSN

      NAT=NAT+1

      CRD(3,NAT)=0.0

      CRD(2,NAT)=2.0

      CRD(1,NAT)=FLOAT(NADD)*0.5+2.5

      IZP(NAT)=-2

      NM=INTDIM

      CALL  ADDAT(CRD,3,NAT,EQUIV,IZP,MM,NN,NNDIM,NM,PADBND,

     1NE,EE,NP,VEC,IW,NED,PADDOV,PADD)

      CALL OUT(6,NAT,0,IZP,IW,VEC,NED,NE,NAT,MM,NN,NNDIM,INTDIM,EE,NP)

C

C  CONSTRUCT INITIAL WAVE FUNCTION NONZERO ON LAST ATOM AND

C  COMPUTE CONTINUED FRACTION

C

      NSTRT=NAT

      WRITE(6,44) NSTRT

44    FORMAT(I6,' ATOM TAKEN AS STARTING POINT'//)

C

C COMPUTES LOCAL D.O.S. RECURSION CFTS. FOR  THE THREE ORBITALS ON THE

C STARTING ATOM. IZERO IS AN ARRAY SET UP TO AVIOD UNNECCESSARY MATRIX

C MULTIPLICATIONS: IZERO(I)=0 IMPLIES PSI(.,I)=0.0  AND

C THE ROUTINE HOP UPDATES THIS WITH EACH APPLICATION OF THE MATRIX.

C

      WRITE(1,8)(CRD(K,NSTRT),K=1,3)

8     FORMAT(' ADD ATOM POSITION',3E13.5)

9     FORMAT(' ORBITAL',I3)

      DO 15 III=1,NORP

        CALL CLCK4X

      DO 11 I=1,NAT

      IZERO(I)=0

      DO 11 J=1,NP

      PSI(J,I)=0.0

11    PMN(J,I)=0.0

      B2(1)=1.0

      A(LL)=0.0

      PSI(III,NSTRT)=1.0

      IZERO(NSTRT)=1

      CALL RECAL(HOP,PSI,PMN,NAT*NP,A,B2,LL)

      WRITE(1,9)III

12    FORMAT(48H CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1,,I3)

      WRITE(1,13)(A(I),B2(I),I=1,LL)

13    FORMAT(2E14.6)

        CALL CLCK3F(IT)

        WRITE(6,14)IT

14      FORMAT(35H TIME TO COMPUTE TRIDIAGONALISATION,I6)

      ICODE=III

      IF(III.EQ.NORP)ICODE=NP

C

C 'PEEL' THE ORBITAL FOR WHICH WE HAVE COMPUTED THE CONTINUED FRACTION

C

      CALL ORPEEL(NSTRT,III,ICODE,MM,NN,NNDIM,INTDIM,EE,NP,NE,NED,MEM)

15    CONTINUE

C

C DETACH ATOM READY FOR A RUN WITH A NEW POSITION

C

      MEM(1,1)=1

      DO 16 I=1,NAT

16    IZERO(I)=IZP(I)

      IZERO(NAT)=3

      CALL PEEL(CRD,3,NAT,NN,NNDIM,INTDIM,MEM,1,IZP,IZERO,2,PSI)

17    CONTINUE

      STOP

      END

      SUBROUTINE HOP(PSI,PMN,AN)

      INTEGER*2 MM,NN,IZERO,IDUM

      DOUBLE PRECISION SUM,DUM

      DIMENSION PSI(5,100),PMN(5,100),DUM(5)

      COMMON /BLKREC/NN(100,15),MM(100,15),NAT,NP,EE(5,5,60),IZERO(100)

      COMMON IDUM(100)

C

C HOP SATISFIES THE SPEC. IN RECAL. UNLABELLED COMMON IS USED FOR

C AN INTEGER*2 WORK ARRAY.ALL INFORMATION FOR THE MATRIX DEFINITION

C IS HELD IN THE COMMON BLOCK /BLKREC/ WHICH WAS ASSIGNED BY A CALL TO

C SETUP

C

C   IZERO(I)=0 INDICATES PSI(.,I)=0.0 AND HENCE THAT CERTAIN LINES

C MAY BE SKIPPED TO SAVE TIME.

C

      SUM=0.0

      DO 4 I=1,NAT

C

C THE MATRIX MULTIPLICATION PROCEEDS A LINE AT A TIME BY COMPUTING

C AT EACH SITE I THE EFFECT OF THE HAMILTONIAN OPERATING AT EACH

C OF ITS NEIGHBOURING SITES, WHICH ARE DEFINED BY NN(I,.)

C THE PRODUCT VECTOR IS ACCUMULATED IN DUM AND THE INNER PRODUCT

C <PSI H PSI> IN SUM.

C

      IDUM(I)=IZERO(I)

      DO 11 L=1,NP

11    DUM(L)=0.0

      JSZ=NN(I,1)

      IE=MM(I,1)

      IF(IZERO(I).EQ.0)GOTO 10

C

C MULTIPLY PSI(I) BY THE 'SELF ENERGY' MATRIX (OR DIAGONAL SUBMATRIX)

C

      DO 1 M=1,NP

      DO 1 L=1,NP

1     DUM(L)=DUM(L)+EE(L,M,IE)*PSI(M,I)

10    IF(JSZ.LT.2)GOTO 3

      DO 12 J=2,JSZ

      JJ=NN(I,J)

      IF(IZERO(JJ).EQ.0)GOTO 12

      IE=MM(I,J)

C

C MULTIPLY PSI(.,JJ) BY THE APPROPRIATE SUBMATRIX TO CALCULATE THE

C EFFECT AT SITE I OF THE HAMILTONIAN OPERATING AT SITE JJ.NOTE

C THE PSI(.,I) IS NOW NON-ZERO AND THIS IS RECORDED IN IDUM FOR

C LATER COPYING TO IZERO

C

      DO 2 M=1,NP

      DO 2 L=1,NP

2     DUM(L)=DUM(L)+EE(L,M,IE)*PSI(M,JJ)

      IDUM(I)=1

12    CONTINUE

C

C ACCUMULATE THE REQUIRED INNER PRODUCT AND OVERWRITE PMN

C

3     DO 4 L=1,NP

      SUM=SUM+DUM(L)*PSI(L,I)

4     PMN(L,I)=DUM(L)+PMN(L,I)

      AN=SUM

      DO 14 I=1,NAT

14    IZERO(I)=IDUM(I)

      RETURN

      END

      INTEGER FUNCTION PADBND(I,J,R2,DD)

C

C  FUNCTION DEFINING 'NEIGHBOUR' FOR THE ADD ATOM :

C  TAKES THE VALUE 1 IF I & J ARE NEIGHBOURS , 0 OTHERWISE

C

      PADBND=0

      IF(R2.GT.4.0)RETURN

      PADBND=1

      RETURN

      END

      SUBROUTINE PADD(DUM,I,J,EM,OVP)

      DIMENSION DUM(3),X(6),X2(6),EM(5,5),E(5,5)

      EXTERNAL OVP

C

C  COMPUTES THE OVERLAP MATRICES FOR THE ADD ATOM : P-D AND PP

C  ELECTRONS . SATISFIES THE SPEC OF HCAL FOR SETUP  AND ADDAT.

C





      R2=0.0

      DO 1 L=1,3

      X(L)=DUM(L)

      X2(L)=X(L)*X(L)

1     R2=R2+X2(L)

      DO 6 L=1,5

      DO 6 M=1,5

6     EM(L,M)=0.0

      IF(R2.LT.1.0E-4)GOTO 5

      R2I=1.0/R2

      RI=SQRT(R2I)

      DO 2 L=1,3

      X(L)=X(L)*RI

      X(L+3)=X(L)

      X2(L)=X2(L)*R2I

2     X2(L+3)=X2(L)

      IF(I.EQ.J)GOTO 4

      IF(J.EQ.1)GOTO 3

      CALL SKPD(X,X2,I,J,R2,OVP,E,EM,5)

      RETURN

3     CALL SKPD(X,X2,I,J,R2,OVP,EM,E,5)

      RETURN

4     CALL SKPP(X,X2,I,J,R2,OVP,EM,5)

      RETURN

5     CALL SELFP(I,J,R2,OVP,EM,5)

      RETURN

      END

      INTEGER FUNCTION PADDOV(I,J,R2,PAR)

      DIMENSION PAR(13)

C

C RETURNS THE VALUES OF THE OVERLAP PARAMETERS FOR THE ADD ATOMS.

C

C  PAR(4)= P D SIGMA

C  PAR(5)= P D PI

C  PAR(6)= P P SIGMA

C  PAR(7)= P P PI

C  PAR(12) = SELF ENERGY  OF P ELECTRON

C

      PADDOV=1

      PAR(4)=0.04

      PAR(5)=-0.003

      PAR(6)=0.2

      PAR(7)=-0.002

      PAR(12)=0.5

      RETURN

      END

ENDPROG

ENDJOB

./ ADD NAME=OPORPEEL

EXAMPLE OF RECURSION WITH ORBITAL PEELING

LATTICE COORDINATES

   1 2.0 1.0 1.0    2 4.0 1.0 1.0    3 1.0 2.0 1.0    4 3.0 2.0 1.0

   5 5.0 2.0 1.0    6 2.0 3.0 1.0    7 4.0 3.0 1.0    8 1.0 4.0 1.0

   9 3.0 4.0 1.0   10 5.0 4.0 1.0   11 2.0 5.0 1.0   12 4.0 5.0 1.0

  13 1.0 1.0 2.0   14 3.0 1.0 2.0   15 5.0 1.0 2.0   16 2.0 2.0 2.0

  17 4.0 2.0 2.0   18 1.0 3.0 2.0   19 3.0 3.0 2.0   20 5.0 3.0 2.0

  21 2.0 4.0 2.0   22 4.0 4.0 2.0   23 1.0 5.0 2.0   24 3.0 5.0 2.0

  25 5.0 5.0 2.0   26 2.0 1.0 3.0   27 4.0 1.0 3.0   28 1.0 2.0 3.0

  29 3.0 2.0 3.0   30 5.0 2.0 3.0   31 2.0 3.0 3.0   32 4.0 3.0 3.0

  33 1.0 4.0 3.0   34 3.0 4.0 3.0   35 5.0 4.0 3.0   36 2.0 5.0 3.0

  37 4.0 5.0 3.0   38 1.0 1.0 4.0   39 3.0 1.0 4.0   40 5.0 1.0 4.0

  41 2.0 2.0 4.0   42 4.0 2.0 4.0   43 1.0 3.0 4.0   44 3.0 3.0 4.0

  45 5.0 3.0 4.0   46 2.0 4.0 4.0   47 4.0 4.0 4.0   48 1.0 5.0 4.0

  49 3.0 5.0 4.0   50 5.0 5.0 4.0   51 2.0 1.0 5.0   52 4.0 1.0 5.0

  53 1.0 2.0 5.0   54 3.0 2.0 5.0   55 5.0 2.0 5.0   56 2.0 3.0 5.0

  57 4.0 3.0 5.0   58 1.0 4.0 5.0   59 3.0 4.0 5.0   60 5.0 4.0 5.0

  61 2.0 5.0 5.0   62 4.0 5.0 5.0   63 1.0 1.0 6.0   64 3.0 1.0 6.0

  65 5.0 1.0 6.0   66 2.0 2.0 6.0   67 4.0 2.0 6.0   68 1.0 3.0 6.0

  69 3.0 3.0 6.0   70 5.0 3.0 6.0   71 2.0 4.0 6.0   72 4.0 4.0 6.0

  73 1.0 5.0 6.0   74 3.0 5.0 6.0   75 5.0 5.0 6.0

TIME IN SETUP    10

NEAREST NEIGHBOUR MAP

ATOM TYPE CONNECTIVITY     NEIGHBOURS

   1  1  6    3    4   13   14   16

   2  1  6    4    5   14   15   17

   3  1  6    1    6   13   16   18

   4  1  9    1    2    6    7   14   16   17   19

   5  1  6    2    7   15   17   20

   6  1  9    3    4    8    9   16   18   19   21

   7  1  9    4    5    9   10   17   19   20   22

   8  1  6    6   11   18   21   23

   9  1  9    6    7   11   12   19   21   22   24

  10  1  6    7   12   20   22   25

  11  1  6    8    9   21   23   24

  12  1  6    9   10   22   24   25

  13  1  6    1    3   16   26   28

  14  1  9    1    2    4   16   17   26   27   29

  15  1  6    2    5   17   27   30

  16  1 13    1    3    4    6   13   14   18   19   26   28   29   31

  17  1 13    2    4    5    7   14   15   19   20   27   29   30   32

  18  1  9    3    6    8   16   21   28   31   33

  19  1 13    4    6    7    9   16   17   21   22   29   31   32   34

  20  1  9    5    7   10   17   22   30   32   35

  21  1 13    6    8    9   11   18   19   23   24   31   33   34   36

  22  1 13    7    9   10   12   19   20   24   25   32   34   35   37

  23  1  6    8   11   21   33   36

  24  1  9    9   11   12   21   22   34   36   37

  25  1  6   10   12   22   35   37

  26  1  9   13   14   16   28   29   38   39   41

  27  1  9   14   15   17   29   30   39   40   42

  28  1  9   13   16   18   26   31   38   41   43

  29  1 13   14   16   17   19   26   27   31   32   39   41   42   44

  30  1  9   15   17   20   27   32   40   42   45

  31  1 13   16   18   19   21   28   29   33   34   41   43   44   46

  32  1 13   17   19   20   22   29   30   34   35   42   44   45   47

  33  1  9   18   21   23   31   36   43   46   48

  34  1 13   19   21   22   24   31   32   36   37   44   46   47   49

  35  1  9   20   22   25   32   37   45   47   50

  36  1  9   21   23   24   33   34   46   48   49

  37  1  9   22   24   25   34   35   47   49   50

  38  1  6   26   28   41   51   53

  39  1  9   26   27   29   41   42   51   52   54

  40  1  6   27   30   42   52   55

  41  1 13   26   28   29   31   38   39   43   44   51   53   54   56

  42  1 13   27   29   30   32   39   40   44   45   52   54   55   57

  43  1  9   28   31   33   41   46   53   56   58

  44  1 13   29   31   32   34   41   42   46   47   54   56   57   59

  45  1  9   30   32   35   42   47   55   57   60

  46  1 13   31   33   34   36   43   44   48   49   56   58   59   61

  47  1 13   32   34   35   37   44   45   49   50   57   59   60   62

  48  1  6   33   36   46   58   61

  49  1  9   34   36   37   46   47   59   61   62

  50  1  6   35   37   47   60   62

  51  1  9   38   39   41   53   54   63   64   66

  52  1  9   39   40   42   54   55   64   65   67

  53  1  9   38   41   43   51   56   63   66   68

  54  1 13   39   41   42   44   51   52   56   57   64   66   67   69

  55  1  9   40   42   45   52   57   65   67   70

  56  1 13   41   43   44   46   53   54   58   59   66   68   69   71

  57  1 13   42   44   45   47   54   55   59   60   67   69   70   72

  58  1  9   43   46   48   56   61   68   71   73

  59  1 13   44   46   47   49   56   57   61   62   69   71   72   74

  60  1  9   45   47   50   57   62   70   72   75

  61  1  9   46   48   49   58   59   71   73   74

  62  1  9   47   49   50   59   60   72   74   75

  63  1  4   51   53   66

  64  1  6   51   52   54   66   67

  65  1  4   52   55   67

  66  1  9   51   53   54   56   63   64   68   69

  67  1  9   52   54   55   57   64   65   69   70

  68  1  6   53   56   58   66   71

  69  1  9   54   56   57   59   66   67   71   72

  70  1  6   55   57   60   67   72

  71  1  9   56   58   59   61   68   69   73   74

  72  1  9   57   59   60   62   69   70   74   75

  73  1  4   58   61   71

  74  1  6   59   61   62   71   72

  75  1  4   60   62   72

   13 NON-EQUIVALENT VECTORS FOUND

     ATOM     INDEX OF INTERACTION VECTORS

   1   13    1    2    3    4    5

   2   13    1    2    3    4    5

   3   13    6    2    7    4    5

   4   13    8    6    1    2    7    3    4    5

   5   13    8    1    7    3    5

   6   13    8    6    1    2    7    3    4    5

   7   13    8    6    1    2    7    3    4    5

   8   13    6    2    7    4    5

   9   13    8    6    1    2    7    3    4    5

  10   13    8    1    7    3    5

  11   13    8    6    7    3    4

  12   13    8    6    7    3    4

  13   13    9   10    2    4    5

  14   13   11    9   10    1    2    3    4    5

  15   13   11   10    1    3    5

  16   13   12   11    9   10    8    6    1    2    7    3    4    5

  17   13   12   11    9   10    8    6    1    2    7    3    4    5

  18   13   12    9   10    6    2    7    4    5

  19   13   12   11    9   10    8    6    1    2    7    3    4    5

  20   13   12   11   10    8    1    7    3    5

  21   13   12   11    9   10    8    6    1    2    7    3    4    5

  22   13   12   11    9   10    8    6    1    2    7    3    4    5

  23   13   12    9    6    7    4

  24   13   12   11    9    8    6    7    3    4

  25   13   12   11    8    7    3

  26   13   11    9   10    1    2    3    4    5

  27   13   11    9   10    1    2    3    4    5

  28   13   12    9   10    6    2    7    4    5

  29   13   12   11    9   10    8    6    1    2    7    3    4    5

  30   13   12   11   10    8    1    7    3    5

  31   13   12   11    9   10    8    6    1    2    7    3    4    5

  32   13   12   11    9   10    8    6    1    2    7    3    4    5

  33   13   12    9   10    6    2    7    4    5

  34   13   12   11    9   10    8    6    1    2    7    3    4    5

  35   13   12   11   10    8    1    7    3    5

  36   13   12   11    9    8    6    7    3    4

  37   13   12   11    9    8    6    7    3    4

  38   13    9   10    2    4    5

  39   13   11    9   10    1    2    3    4    5

  40   13   11   10    1    3    5

  41   13   12   11    9   10    8    6    1    2    7    3    4    5

  42   13   12   11    9   10    8    6    1    2    7    3    4    5

  43   13   12    9   10    6    2    7    4    5

  44   13   12   11    9   10    8    6    1    2    7    3    4    5

  45   13   12   11   10    8    1    7    3    5

  46   13   12   11    9   10    8    6    1    2    7    3    4    5

  47   13   12   11    9   10    8    6    1    2    7    3    4    5

  48   13   12    9    6    7    4

  49   13   12   11    9    8    6    7    3    4

  50   13   12   11    8    7    3

  51   13   11    9   10    1    2    3    4    5

  52   13   11    9   10    1    2    3    4    5

  53   13   12    9   10    6    2    7    4    5

  54   13   12   11    9   10    8    6    1    2    7    3    4    5

  55   13   12   11   10    8    1    7    3    5

  56   13   12   11    9   10    8    6    1    2    7    3    4    5

  57   13   12   11    9   10    8    6    1    2    7    3    4    5

  58   13   12    9   10    6    2    7    4    5

  59   13   12   11    9   10    8    6    1    2    7    3    4    5

  60   13   12   11   10    8    1    7    3    5

  61   13   12   11    9    8    6    7    3    4

  62   13   12   11    9    8    6    7    3    4

  63   13    9   10    2

  64   13   11    9   10    1    2

  65   13   11   10    1

  66   13   12   11    9   10    8    6    1    2

  67   13   12   11    9   10    8    6    1    2

  68   13   12    9   10    6    2

  69   13   12   11    9   10    8    6    1    2

  70   13   12   11   10    8    1

  71   13   12   11    9   10    8    6    1    2

  72   13   12   11    9   10    8    6    1    2

  73   13   12    9    6

  74   13   12   11    9    8    6

  75   13   12   11    8

    INDEX LATTICE TYPES   VECTOR                              MATRIX

      1     1  1    -1.00  1.00  0.00 -0.021  0.000  0.000  0.000 -0.011

                                       0.000  0.005 -0.007  0.000  0.000

                                       0.000 -0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                      -0.011  0.000  0.000  0.000 -0.008

      2     1  1     1.00  1.00  0.00 -0.021  0.000  0.000  0.000  0.011

                                       0.000  0.005  0.007  0.000  0.000

                                       0.000  0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                       0.011  0.000  0.000  0.000 -0.008

      3     1  1    -1.00  0.00  1.00  0.005 -0.007  0.000  0.000  0.000

                                      -0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021  0.010  0.006

                                       0.000  0.000  0.010 -0.003 -0.009

                                       0.000  0.000  0.006 -0.009  0.007

      4     1  1     1.00  0.00  1.00  0.005  0.007  0.000  0.000  0.000

                                       0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021 -0.010 -0.006

                                       0.000  0.000 -0.010 -0.003 -0.009

                                       0.000  0.000 -0.006 -0.009  0.007

      5     1  1     0.00  1.00  1.00  0.005  0.000  0.007  0.000  0.000

                                       0.000 -0.021  0.000  0.010 -0.006

                                       0.007  0.000  0.005  0.000  0.000

                                       0.000  0.010  0.000 -0.003  0.009

                                       0.000 -0.006  0.000  0.009  0.007

      6     1  1     1.00 -1.00  0.00 -0.021  0.000  0.000  0.000 -0.011

                                       0.000  0.005 -0.007  0.000  0.000

                                       0.000 -0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                      -0.011  0.000  0.000  0.000 -0.008

      7     1  1     0.00 -1.00  1.00  0.005  0.000 -0.007  0.000  0.000

                                       0.000 -0.021  0.000 -0.010  0.006

                                      -0.007  0.000  0.005  0.000  0.000

                                       0.000 -0.010  0.000 -0.003  0.009

                                       0.000  0.006  0.000  0.009  0.007

      8     1  1    -1.00 -1.00  0.00 -0.021  0.000  0.000  0.000  0.011

                                       0.000  0.005  0.007  0.000  0.000

                                       0.000  0.007  0.005  0.000  0.000

                                       0.000  0.000  0.000  0.013  0.000

                                       0.011  0.000  0.000  0.000 -0.008

      9     1  1     1.00  0.00 -1.00  0.005 -0.007  0.000  0.000  0.000

                                      -0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021  0.010  0.006

                                       0.000  0.000  0.010 -0.003 -0.009

                                       0.000  0.000  0.006 -0.009  0.007

     10     1  1     0.00  1.00 -1.00  0.005  0.000 -0.007  0.000  0.000

                                       0.000 -0.021  0.000 -0.010  0.006

                                      -0.007  0.000  0.005  0.000  0.000

                                       0.000 -0.010  0.000 -0.003  0.009

                                       0.000  0.006  0.000  0.009  0.007

     11     1  1    -1.00  0.00 -1.00  0.005  0.007  0.000  0.000  0.000

                                       0.007  0.005  0.000  0.000  0.000

                                       0.000  0.000 -0.021 -0.010 -0.006

                                       0.000  0.000 -0.010 -0.003 -0.009

                                       0.000  0.000 -0.006 -0.009  0.007

     12     1  1     0.00 -1.00 -1.00  0.005  0.000  0.007  0.000  0.000

                                       0.000 -0.021  0.000  0.010 -0.006

                                       0.007  0.000  0.005  0.000  0.000

                                       0.000  0.010  0.000 -0.003  0.009

                                       0.000 -0.006  0.000  0.009  0.007

     13     1  1     0.00  0.00  0.00  0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

TIME IN ADDAT     0

NEAREST NEIGHBOUR MAP

ATOM TYPE CONNECTIVITY     NEIGHBOURS

  76 -2  6    1    3    4    6   16

   24 NON-EQUIVALENT VECTORS FOUND

     ATOM     INDEX OF INTERACTION VECTORS

  76   24   19   20   21   22   23

    INDEX LATTICE TYPES   VECTOR                              MATRIX

     13     1  1     0.00  0.00  0.00  0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

     14     1  2     0.00  1.00 -1.00  0.002  0.000  0.000  0.000  0.000

                                       0.000  0.024 -0.024  0.000  0.000

                                      -0.002  0.000  0.000  0.000  0.000

                                       0.000  0.011 -0.013  0.000  0.000

                                       0.000 -0.009  0.005  0.000  0.000

     15     1  2     1.00  0.00 -1.00  0.000  0.002  0.000  0.000  0.000

                                       0.000 -0.002  0.000  0.000  0.000

                                       0.024  0.000 -0.024  0.000  0.000

                                      -0.011  0.000  0.013  0.000  0.000

                                      -0.009  0.000  0.005  0.000  0.000

     16     1  2    -1.00  0.00 -1.00  0.000 -0.002  0.000  0.000  0.000

                                       0.000 -0.002  0.000  0.000  0.000

                                       0.024  0.000  0.024  0.000  0.000

                                       0.011  0.000  0.013  0.000  0.000

                                       0.009  0.000  0.005  0.000  0.000

     17     1  2     0.00 -1.00 -1.00 -0.002  0.000  0.000  0.000  0.000

                                       0.000  0.024  0.024  0.000  0.000

                                      -0.002  0.000  0.000  0.000  0.000

                                       0.000 -0.011 -0.013  0.000  0.000

                                       0.000  0.009  0.005  0.000  0.000

     18     1  2     0.00  0.00 -2.00  0.000  0.000  0.000  0.000  0.000

                                       0.000 -0.003  0.000  0.000  0.000

                                      -0.003  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.040  0.000  0.000

     19     2  1     0.00 -1.00  1.00  0.002  0.000 -0.002  0.000  0.000

                                       0.000  0.024  0.000  0.011 -0.009

                                       0.000 -0.024  0.000 -0.013  0.005

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000







***** #PRC SUBSYSTEM STREAM RESUMPTION *****

     20     2  1    -1.00  0.00  1.00  0.000  0.000  0.024 -0.011 -0.009

                                       0.002 -0.002  0.000  0.000  0.000

                                       0.000  0.000 -0.024  0.013  0.005

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

     21     2  1     1.00  0.00  1.00  0.000  0.000  0.024  0.011  0.009

                                      -0.002 -0.002  0.000  0.000  0.000

                                       0.000  0.000  0.024  0.013  0.005

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

     22     2  1     0.00  1.00  1.00 -0.002  0.000 -0.002  0.000  0.000

                                       0.000  0.024  0.000 -0.011  0.009

                                       0.000  0.024  0.000 -0.013  0.005

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

     23     2  1     0.00  0.00  2.00  0.000  0.000 -0.003  0.000  0.000

                                       0.000 -0.003  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.040

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

     24     2  2     0.00  0.00  0.00  0.500  0.000  0.000  0.000  0.000

                                       0.000  0.500  0.000  0.000  0.000

                                       0.000  0.000  0.500  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

                                       0.000  0.000  0.000  0.000  0.000

NEAREST NEIGHBOUR MAP

ATOM TYPE CONNECTIVITY     NEIGHBOURS

  77 -2  7    1    2    4    6    7   76

   36 NON-EQUIVALENT VECTORS FOUND

     ATOM     INDEX OF INTERACTION VECTORS

  77   24   31   32   33   34   35   36

   77 ATOM TAKEN AS STARTING POINT

TIME TO COMPUTE TRIDIAGONALISATION    20

TIME TO COMPUTE TRIDIAGONALISATION    20

TIME TO COMPUTE TRIDIAGONALISATION    19

NEAREST NEIGHBOUR MAP

ATOM TYPE CONNECTIVITY     NEIGHBOURS

  77 -2  6    2    4    5    7   76

   46 NON-EQUIVALENT VECTORS FOUND

     ATOM     INDEX OF INTERACTION VECTORS

  77   24   42   43   44   45   46

   77 ATOM TAKEN AS STARTING POINT

TIME TO COMPUTE TRIDIAGONALISATION    19

TIME TO COMPUTE TRIDIAGONALISATION    19

TIME TO COMPUTE TRIDIAGONALISATION    19

./ ENDUP











./ ADD NAME=CFTPEEL

CONTINUED FRACTION COEFFICIENTS A(I),B2(I),I=1, 11

ORBITAL PEELING ON A     76 ATOM FCC CLUSTER

   2 POSTIONS  3 ORBITALS PER POSITION

ADD ATOM POSITION  0.30000E+01  0.20000E+01  0.00000E+00

ORBITAL  1

  0.500000E+00  0.100000E+01

  0.472490E+00  0.421663E-01

  0.195485E-01  0.148046E-01

-0.474055E-02  0.149503E-02

  0.273241E+00  0.494780E-02

  0.195113E+00  0.687933E-01

-0.102151E-01  0.334883E-02

-0.147545E-01  0.214047E-02

  0.342035E+00  0.637294E-02

  0.175120E+00  0.626467E-01

  0.000000E+00  0.143511E-01

ORBITAL  2

  0.500000E+00  0.100000E+01

-0.210645E-02  0.217033E-02

  0.189660E-01  0.164294E-02

  0.418913E+00  0.116863E-01

  0.243933E-01  0.285045E-01

-0.138919E-01  0.225610E-02

-0.208938E-01  0.223641E-02

  0.191802E-01  0.223003E-02

  0.424895E+00  0.159673E-01

  0.386033E-01  0.232389E-01

  0.000000E+00  0.202028E-02

ORBITAL  3

  0.500000E+00  0.100000E+01

  0.150466E-01  0.376133E-02

  0.137119E-01  0.141815E-02

  0.442441E+00  0.130259E-01

  0.238727E-01  0.165956E-01

  0.974502E-02  0.165485E-02

  0.414811E+00  0.103798E-01

  0.488939E-01  0.332176E-01

-0.186314E-01  0.236497E-02

-0.245824E-01  0.223357E-02

  0.000000E+00  0.222820E-02

ADD ATOM POSITION  0.35000E+01  0.20000E+01  0.00000E+00

ORBITAL  1

  0.500000E+00  0.100000E+01

  0.479266E+00  0.418092E-01

  0.149541E-01  0.116840E-01

-0.393662E-02  0.805302E-03

  0.323287E+00  0.399280E-02

  0.164708E+00  0.588453E-01

-0.130959E-01  0.296249E-02

  0.249305E+00  0.391418E-02

  0.218901E+00  0.716211E-01

  0.293668E-01  0.434358E-02

  0.000000E+00  0.267288E-01

ORBITAL  2

  0.500000E+00  0.100000E+01

  0.121590E-02  0.145422E-02

  0.149097E+00  0.220581E-02

  0.327785E+00  0.569488E-01

-0.534916E-02  0.639670E-02

-0.176335E-01  0.227237E-02

-0.143229E-01  0.192824E-02

  0.305057E-01  0.269906E-02

  0.429294E+00  0.240395E-01

  0.144589E-01  0.153132E-01

  0.000000E+00  0.199830E-02

ORBITAL  3

  0.500000E+00  0.100000E+01

-0.607080E-02  0.321656E-02

  0.165253E+00  0.198901E-02

  0.330382E+00  0.577389E-01

-0.199082E-01  0.466610E-02

  0.185080E-01  0.211702E-02

  0.413457E+00  0.199067E-01

  0.211744E-01  0.232999E-01

-0.108829E-01  0.218336E-02

-0.124163E-01  0.188544E-02

  0.000000E+00  0.175913E-02

./ ADD NAME=EXPEELED

RUNFILE FROM %H=ENDJOB PRINT=SAVE

FILE SSTLIB.CAMREC84:CFTPEEL TO &DAT/W/FB

FTVSCLR PROGRAM=%H=ENDPROG DD=FT05F001=&DAT LIBRARY=SSTLIB.TCMLIB.DCOM

      IMPLICIT REAL*8(A-H,O-Z)

      DIMENSION A(30,3),B2(30,3),WK(30,4),IWK(30,2),HEAD(6),E(201)

     1,EN(201,10),NL(2)

      NPTS=17

      ND=30

      ELO=-0.2

      EHI=0.6

      EPS=5.0E-12

      LL=7

C

C  NPTS IS THE NUMBER OF POINTS TO BE USED IN PLOTTING

C  ELO-EHI IS THE RANGE OF ENERGIES OF INTEREST,

C  EPS IS THE ACCURACY REQUIRED

C  LL IS THE LENGTH OF THE C.F.

C

C  INPUT THE RESULTS OF THE ORPEEL EXAMPLE PROGRAM

C

C

C  LLIN  LENGTH OF C.F.S ON INPUT

C  NPOS  NUMBER OF SETS OF C.F.S

C  NORP  NUMBER OF C.F.S IN EACH SET

C

      READ(5,1)LLIN

1     FORMAT(48X,I3)

      LL=MIN0(LL,LLIN)

      WRITE(6,2)LL

2     FORMAT(' EXAMPLE OF ENERGY CALCULATION IN ORBITAL PEELING',/I4,

     1' LEVELS USED')

      READ(5,3)HEAD,NPOS,NORP

3     FORMAT(22X,6A4,/I4,9X,I3)

      WRITE(6,32)HEAD,NPOS,NORP

32    FORMAT(1X,6A4,I4,' SETS OF',I4,' ORBITALS EACH')

C

C  TABULATE VALUES OF FERMI ENERGY REQUIRED

C

      DE=(EHI-ELO)/FLOAT(NPTS-1)

      DO 34 I=1,NPTS

34    E(I)=ELO+FLOAT(I-1)*DE

C

C  COMPUTE TOTAL ENERGY DIFFERENCE FOR EACH SET OF COEFFICIENTS

C

      DO 10 IPOS=1,NPOS

      READ(5,35)(HEAD(I),I=1,4),(WK(1,K),K=1,3)

35    FORMAT(2X,4A4,3E13.5)

      WRITE(6,36)(HEAD(I),I=1,4),(WK(1,K),K=1,3)

36    FORMAT(///2X,4A4,3F6.2)

      DO 6 I=1,NORP

      READ(5,1)

      READ(5,4)(A(J,I),B2(J,I),J=1,LLIN)

4     FORMAT(2E14.6)

5     FORMAT(' INPUT CONTINUED FRACTION CFTS.',50(/1X,6E11.4))

6     CONTINUE

      WRITE(6,5)((A(I,J),B2(I,J),J=1,NORP),I=1,LL)

C

C   COMPUTE THE TOTAL ENERGY DIFFERENCE  AT EACH VALUE OF

C   THE FERMI ENERGY AND STORE THE RESULT IN EN

C

      DO 9 I=1,NPTS

      EN(I,IPOS)=0.0

      DO 8 K=1,NORP

8     EN(I,IPOS)=EN(I,IPOS)+EDIFF(E(I),A(1,K),B2(1,K),LL,EPS,WK,IWK)

9     CONTINUE

10    CONTINUE

      WRITE(6,105)(I,I=1,NPOS)

105   FORMAT(////' TOTAL ENERGY DIFFERENCES TABULATED AGAINST FERMI ENER

     1GY',/7X,'EF',9(5X,I3,' POSN'))

      DO 11 I=1,NPTS

      WRITE(6,12)E(I),(EN(I,J),J=1,NPOS)

11    CONTINUE

12    FORMAT(10E13.5)

      STOP

      END

ENDPROG

ENDJOB

./ ADD NAME=OPPEELED

EXAMPLE OF ENERGY CALCULATION IN ORBITAL PEELING

  7 LEVELS USED

    76 ATOM FCC CLUSTER    2 SETS OF   3 ORBITALS EACH





DD ATOM POSITION  3.00  2.00  0.00

INPUT CONTINUED FRACTION CFTS.

0.5000D+00 0.1000D+01 0.5000D+00 0.1000D+01 0.5000D+00 0.1000D+01

0.4725D+00 0.4217D-01-0.2106D-02 0.2170D-02 0.1505D-01 0.3761D-02

0.1955D-01 0.1480D-01 0.1897D-01 0.1643D-02 0.1371D-01 0.1418D-02

-0.4741D-02 0.1495D-02 0.4189D+00 0.1169D-01 0.4424D+00 0.1303D-01

0.2732D+00 0.4948D-02 0.2439D-01 0.2850D-01 0.2387D-01 0.1660D-01

0.1951D+00 0.6879D-01-0.1389D-01 0.2256D-02 0.9745D-02 0.1655D-02

-0.1022D-01 0.3349D-02-0.2089D-01 0.2236D-02 0.4148D+00 0.1038D-01





DD ATOM POSITION  3.50  2.00  0.00

INPUT CONTINUED FRACTION CFTS.

0.5000D+00 0.1000D+01 0.5000D+00 0.1000D+01 0.5000D+00 0.1000D+01

0.4793D+00 0.4181D-01 0.1216D-02 0.1454D-02-0.6071D-02 0.3217D-02

0.1495D-01 0.1168D-01 0.1491D+00 0.2206D-02 0.1653D+00 0.1989D-02

-0.3937D-02 0.8053D-03 0.3278D+00 0.5695D-01 0.3304D+00 0.5774D-01

0.3233D+00 0.3993D-02-0.5349D-02 0.6397D-02-0.1991D-01 0.4666D-02

0.1647D+00 0.5885D-01-0.1763D-01 0.2272D-02 0.1851D-01 0.2117D-02

-0.1310D-01 0.2962D-02-0.1432D-01 0.1928D-02 0.4135D+00 0.1991D-01





TOTAL ENERGY DIFFERENCES TABULATED AGAINST FERMI ENERGY

      EF       1 POSN       2 POSN

-0.20000D+00 -0.25485D-06 -0.14520D-06

-0.15000D+00 -0.30990D-05 -0.18740D-05

-0.10000D+00 -0.13333D-03 -0.84809D-04

-0.50000D-01 -0.39395D-02 -0.34169D-02

0.14901D-07 -0.11195D-01 -0.10739D-01

0.50000D-01 -0.17915D-01 -0.13708D-01

0.10000D+00 -0.17916D-01 -0.13758D-01

0.15000D+00 -0.17916D-01 -0.13758D-01

0.20000D+00 -0.17917D-01 -0.13758D-01

0.25000D+00 -0.17919D-01 -0.13759D-01

0.30000D+00 -0.17958D-01 -0.13774D-01

0.35000D+00 -0.61194D-01 -0.58537D-01

0.40000D+00 -0.11119D+00 -0.10854D+00

0.45000D+00 -0.16119D+00 -0.15854D+00

0.50000D+00 -0.21124D+00 -0.20863D+00

0.55000D+00 -0.30248D+00 -0.30262D+00

0.60000D+00 -0.40248D+00 -0.40262D+00

./ ENDUP

