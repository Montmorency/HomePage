  THE ROUTINES  IN THE  LIBRARY  FALL INTO TWO  CATEGORIES : THOSE

WHICH  ASSIST  IN THE SETTING  UP OF THE  PROBLEM, AND THOSE WHICH

COMPUTE  FROM THE  CALCULATED  COEFFICIENTS  THE  LOCAL DENSITY OF

STATES AND RELATED  FUNCTIONS. THESE ARE  DESCRIBED  SEPARATELY IN

THE FOLLOWING TWO SECTIONS.

  THERE EXISTS IN THE LITERATURE SOME SLIGHT CONFUSION OF NOTATION,

BUT THAT USED IN THE LIBRARY IS  CONSISTENT WITHIN ITSELF AND WITH

THE RECURSION FORMULA :

   B(N+1).PSI(N+1) = ( H - A(N) ).PSI(N) - B(N).PSI(N-1) ,N=0,1,..

WHERE  A(N) = <PSI(N),H.PSI(N)>  AND  B(N+1)  IS  CHOSEN SUCH THAT

<PSI(N+1),PSI(N+1)>=1. PSI(-1) (=0) AND PSI(0) ARE GIVEN.

(WITHIN THE FORTRAN THE SUBSCRIPTS ARE INCREASED BY 1 TO CONFORM TO

FORTRAN IV CONVENTION, ALTHOUGH ALL ROUTINES HAVE ALSO RUN IN

FORTRAN 77 UNDER THE IBM VS COMPILER)









1.2: PROBLEM INITIALISATION ROUTINES





  THE  SYSTEM  ADOPTED  FOR THE SETTING  UP OF THE PROBLEM FOR THE

APPLICATION  OF  THE  RECURSION  METHOD  CONSISTS OF A  LIBRARY OF

ROUTINES  DIVIDED  INTO THREE  SECTIONS , WITH ONLY A SUBSET BEING

USED IN ANY ONE PROBLEM , AND FOR SOME PROBLEMS THE USER SUPPLYING

HIS OWN ROUTINES  TO REPLACE  AND  SUPPLEMENT  SOME OF THE LIBRARY

ONES. THE THREE GROUPS OF ROUTINES ARE AS FOLLOWS: THE FIRST SERVE

TO DEFINE A CLUSTER OF 'ATOM SITES' , THE NEXT SET UP A 'NEIGHBOUR

MAP ' ( OR  MATRIX  SPARSITY  PATTERN ) , AND THE  LAST SET UP THE

COMPONENT SUBMATRICES OF THE HAMILTONIAN . THE APPROPRIATE RESULTS

OF THESE ROUTINES ARE LOADED BY THE USER INTO A COMMON BLOCK WHICH

SHOULD THEN CONTAIN ALL THE  INFORMATION  NECESSARY  TO DEFINE THE

MATRIX  REPRESENTATION OF THE HAMILTONIAN.THIS IS THEN USED BY THE

SUBROUTINE  AT THE  HEART  OF THE  RECURSION  LIBRARY ( RECAL ) TO

OPERATE   WITH  THE   HAMILTONIAN   AND   PRODUCE   THE  RECURSION

COEFFICIENTS.







1.2.1 SUBROUTINES FOR GENERATING A CLUSTER :





  BCCLAT  AND  FCCLAT  GENERATE  CUBOID  CLUSTERS IN  BCC AND  FCC

LATTICES RESPECTIVELY . MORE EXOTIC CLUSTER SHAPES MAY BE OBTAINED

BY  USE   OF  THE   FOLLOWING   ROUTINES   BUT  THEIR   USE  NEEDS

JUSTIFICATION . ONION  WILL  CLASSIFY  EACH  ATOM ACCORDING TO THE

NUMBER OF 'HOPS' FROM A GIVEN  GROUP  OF 'CENTRAL' ATOMS , BUT CAN

ONLY BE USED  AFTER  THE ATOM 'NEIGHBOURS' HAVE BEEN DEFINED (E.G.

BY NNCAL - SEE  BELOW ) ; PEEL  EXCISES  ATOMS  FROM A CLUSTER AND

RENUMBERS THE REMAINING ONES . THE LAST TWO ROUTINES MAY BE USEFUL

TO  USERS  WITH  PARTICULAR  CLUSTER-SHAPE  REQUIREMENTS , BUT  IN

GENERAL  THE  CUBOID CLUSTERS  HAVE PROVED SATISFACTORY FOR ALMOST

ALL APPLICATIONS TO DATE.







1.2.2 THE SETTING-UP OF THE HAMILTONIAN MATRIX.





NNCAL IS THE CENTRAL  SUBROUTINE USED TO SET UP A 'NEIGHBOUR MAP'

OF THE ATOM CLUSTER. THIS USES ANOTHER ROUTINE ('IBONDS') DEFINING

THE NEIGHBOUR  CRITERION ; THIS MAY BE REPLACED  BY THE USER  WITH

MORE  PARTICULAR   REQUIREMENTS ( I.E. FIRST  AND  SECOND  NEAREST

NEIGHBOURS) OR A DIFFERENT LATTICE . ONCE THE NEIGHBOUR MAP IS SET

UP, THE NON-EQUIVALENT  INTERACTIONS  MAY BE  SET UP  USING MMCAL.

THE 'EQUIVALENCE' OF TWO  INTERACTIONS  IS DEFINED  IN  A  ROUTINE

'EQUIV' WHICH  AGAIN  MAY  BE  REPLACED  BY A USER  WITH  SPECIFIC

REQUIREMENTS . MMCAL  GENERATES A LIST OF  NON-EQUIVALENT  VECTORS

WHICH MAY THEN BE  USED  TO SET UP THE 'INTERACTION BLOCKS' OF THE

HAMILTONIAN  MATRIX, FOR INSTANCE AS IN SLKODE TO GIVE THE SLATER-

KOSTER  INTERACTION  MATRICES  FOR THE  5 D-ORBITALS . SUBROUTINES

GENERATING THE THE S,P OR D SLATER-KOSTER MATRICES ARE SUPPLIED IN

THE LIBRARY AND HAVE NAMES STARTING SK-- .

   THE ESSENTIAL INFORMATION DEFINING THE HAMILTONIAN MATRIX FOR A

REGULAR LATTICE MAY BE SET UP BY THE ROUTINE SETUP AND  AMENDMENTS

TO THE MATRIX MADE USING ADDAT, ORPEEL OR PEEL (ADDING OR EXCISING

ATOMS FROM THE CLUSTER ) . FOR A RANDOM SYSTEM AN ALTERNATIVE FORM

OF STORAGE OF THE  HAMILTONIAN  MATRIX IS PROBABLY MORE  EFFICIENT

AND ROUTINES SCAN AND SCAN1 ARE SUPPLIED TO FACILITATE THE SETTING

UP AND OPERATION OF THE MATRIX OF SUCH A PROBLEM.







1.2.3 GENERATION OF RECURSION COEFFICIENTS.





  THE APPROPRIATE  RESULTS OF THE ABOVE SUBROUTINES SHOULD THEN BE

LOADED BY THE USER INTO  A  COMMON  BLOCK  AND USED BY A ROUTINE ,

SUCH  AS  HOP  OF  THE  EXAMPLE  RUN , TO SUPPLY  THE  HAMILTONIAN

OPERATOR REQUIRED BY THE ACTUAL RECURSION SUBROUTINE, RECAL.











1.3: PROCESSING THE RECURSION COEFFICIENTS.







TWO  METHODS  ARE  PROVIDED  FOR  THE   CALCULATION  OF THE LOCAL

DENSITY OF STATES : TERMINOR AND QUADRATURE, AS DESCRIBED IN NEX(3).

IF INTEGRALS ARE THE FINAL OBJECT OF THE CALCULATION THEN QUADRATURE

(DENQD) IS APPROPRIATE , WHILE TO ESTIMATE THE DENSITY ITSELF WITH

SECURE KNOWLEDGE OF THE BAND-GAPS THE ANALYTIC TERMINATOR(DENSQ OR

DENCRS) CAN BE USED.

  IF THE SUM OF SEVERAL DENSITIES OF STATES IS REQUIRED (E.G. OVER

SEVERAL ORBITALS), THIS AGAIN MAY BE DONE EFFICIENTLY BY 'SUMMING'

THEIR TRIDIAGONALISATIONS  USING RECSUM TO PRODUCE A RESULTANT SET

OF COEFFICIENTS . IF THE  FUNCTIONS  SUMMED  ARE VERY DIFFERENT IN

CHARACTER, THIS MAY INTRODUCE SIGNIFICANT ERROR, IN WHICH CASE THE

FUNCTIONS SHOULD BE TABULATED SEPARATELY , BUT AGAIN FOR GRAPHICAL

PURPOSES THE RESULTS OF RECSUM ARE USUALLY ADEQUATE.

  FOR QUANTITATIVE WORK , ONLY THE  INTEGRATED DENSITY OF STATES ,

N(E), FUNCTION VALUES SHOULD BE RELIED ON, AND ANY OTHER FUNCTIONS

COMPUTED FROM THIS ONE. IT SHOULD BE NOTED THAT THE APPROXIMATIONS

OBTAINED FROM THE QUADRATURE  FORMULA ARE NOT ANALYTICALLY RELATED

IN THE WAY ONE MIGHT EXPECT:





INTEGRAL E N(E) DE DOES NOT EQUAL    E N(E) - INTEGRAL N(E) DE





WHERE THE L.H.S AND N(E) REPRESENT VALUES  OBTAINED DIRECTLY  FROM

DENQD. SUCH IDENTITIES ARE USUALLY SATISFIED APPROXIMATELY, BUT IF

PRECISE ANALYTICITY  IS DEMANDED THE  APPROXIMATION TO N(E) SHOULD

BE TAKEN  AND ALL  OTHER RESULTS  COMPUTED  DIRECTLY FROM IT . THE

EXCEPTION IS THAT D/DE N(E) = N(E) BY DEFINITION .


